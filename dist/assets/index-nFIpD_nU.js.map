{"version":3,"mappings":"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","names":["AppShell","btn","day","display","round","timerBar","timerDisplay","timerRound","IDB","__publicField","resolve","reject","request","event","db","sessionsStore","storeName","mode","key","store","data","indexName","query","index","idb","_ProgramManager","seedData","__vitePreload","program","programId","dayId","a","b","ProgramManager","programManager","ViewHome","card","e","blockTypes","exerciseCount","sum","block","type","ViewDay","chip","el","exerciseId","substitute","timerLabel","exercise","setsReps","sub","timerType","BaseTimer","tickInterval","callback","elapsed","remainingInPeriod","currentRound","totalRounds","duration","previousRound","error","milliseconds","totalSeconds","minutes","seconds","totalMs","ms","remainingSeconds","IntervalTimer","intervalSec","exercisesPerInterval","remaining","WorkRestTimer","workSec","restSec","totalSets","periodDuration","timeInSet","currentSet","wasWorkPhase","CircuitTimer","stations","transitionSec","stationTime","s","transitionTime","roundDuration","timeInRound","accumulated","i","stationDuration","transitionDuration","station","prevRound","TabataTimer","highIntensitySec","lowIntensitySec","StopwatchTimer","lastLapTime","lapTime","previousLapTime","_elapsed","TimerFactory","config","restSeconds","sets","WakeLockManager","err","wakeLockManager","BackgroundTimerManager","timeInBackground","notification","backgroundTimerManager","FeedbackManager","enabled","pattern","frequency","volume","oscillator","gainNode","freq","feedbackManager","ViewSession","currentBlock","totalBlocks","totalExercises","completedExercises","startIdx","exercisesToShow","ex","hasBlockTimer","intervalMinutes","progress","setNumber","phase","timerState","isCompleted","isCompoundInterval","primaryButton","isRestingBetweenSets","nextExercise","advanceBy","parts","isIntervalBlock","total","currentRoundIndex","remainingRounds","target","isLastSet","durationText","dialogHtml","dialogElement","discardBtn","saveBtn","currentPhase","secondsRemaining","lastWarnTime","currentTime","progressFill","timerProgress","timerPhase","AppUpdater","newWorker","worker","appUpdater","UpdateIndicator","indicator","Router","path","handler","hash","route","r","homeRoute","params","pathParts","hashParts","matches","router","showHome","content","showDay","viewDay","appShell","check","shadowRoot","showSession","viewSession"],"ignoreList":[],"sources":["../../src/ui/app-shell.ts","../../src/idb.ts","../../src/program.ts","../../src/ui/view-home.ts","../../src/ui/view-day.ts","../../src/timers/timer-engine.ts","../../src/timers/interval.ts","../../src/timers/work-rest.ts","../../src/timers/circuit.ts","../../src/timers/tabata.ts","../../src/timers/stopwatch.ts","../../src/timers/timer-factory.ts","../../src/utils/wake-lock.ts","../../src/utils/background-timer.ts","../../src/utils/feedback.ts","../../src/ui/view-session.ts","../../src/utils/app-updater.ts","../../src/ui/update-indicator.ts","../../src/router.ts","../../src/main.ts"],"sourcesContent":["export class AppShell extends HTMLElement {\n  constructor() {\n    super();\n    this.attachShadow({ mode: 'open' });\n  }\n\n  connectedCallback() {\n    this.render();\n    this.setupEventListeners();\n  }\n\n  private render() {\n    if (!this.shadowRoot) return;\n    \n    this.shadowRoot.innerHTML = `\n      <style>\n        :host {\n          display: block;\n          height: 100vh;\n          height: 100dvh;\n          background: var(--bg-primary);\n          color: var(--text-primary);\n          position: relative;\n        }\n\n        header {\n          position: fixed;\n          top: 0;\n          left: 0;\n          right: 0;\n          background: var(--bg-secondary);\n          padding: env(safe-area-inset-top) 16px 0 16px;\n          border-bottom: 1px solid var(--border);\n          z-index: 10;\n        }\n\n        .header-content {\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          padding: 12px 0;\n        }\n\n        .logo {\n          display: flex;\n          align-items: center;\n        }\n\n        .day-selector {\n          display: flex;\n          gap: 8px;\n        }\n\n        .day-btn {\n          padding: 6px 12px;\n          background: var(--bg-primary);\n          border: 1px solid var(--border);\n          border-radius: 6px;\n          color: var(--text-primary);\n          font-size: 14px;\n          font-weight: 500;\n          cursor: pointer;\n          transition: all 0.2s;\n        }\n\n        .day-btn.active {\n          background: var(--accent);\n          color: white;\n          border-color: var(--accent);\n        }\n\n        .header-actions {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        }\n\n        main {\n          position: absolute;\n          top: calc(env(safe-area-inset-top) + 65px); /* Safe area + header content */\n          left: 0;\n          right: 0;\n          bottom: 0;\n          overflow-y: auto;\n          -webkit-overflow-scrolling: touch;\n          padding: 0;\n          background: var(--bg-primary);\n        }\n\n        .timer-bar {\n          position: fixed;\n          bottom: 0;\n          left: 0;\n          right: 0;\n          background: var(--bg-secondary);\n          border-top: 1px solid var(--border);\n          padding: 12px 16px;\n          padding-bottom: calc(12px + env(safe-area-inset-bottom));\n          display: none;\n          backdrop-filter: blur(10px);\n          -webkit-backdrop-filter: blur(10px);\n        }\n\n        .timer-bar.active {\n          display: block;\n        }\n\n        .timer-content {\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n        }\n\n        .timer-display {\n          font-size: 24px;\n          font-weight: 600;\n          font-variant-numeric: tabular-nums;\n        }\n\n        .timer-controls {\n          display: flex;\n          gap: 8px;\n        }\n\n        .timer-btn {\n          padding: 8px 16px;\n          background: var(--accent);\n          color: white;\n          border: none;\n          border-radius: 6px;\n          font-size: 14px;\n          font-weight: 500;\n          cursor: pointer;\n        }\n\n        .timer-btn.pause {\n          background: var(--warning);\n        }\n\n        .timer-round {\n          font-size: 14px;\n          color: var(--text-secondary);\n        }\n\n        @media (prefers-color-scheme: dark) {\n          :host {\n            --bg-primary: #000000;\n            --bg-secondary: #1a1a1a;\n            --text-primary: #ffffff;\n            --text-secondary: #999999;\n            --border: #333333;\n            --accent: #007AFF;\n            --warning: #FF9500;\n          }\n        }\n\n        @media (prefers-color-scheme: light) {\n          :host {\n            --bg-primary: #ffffff;\n            --bg-secondary: #f5f5f5;\n            --text-primary: #000000;\n            --text-secondary: #666666;\n            --border: #e0e0e0;\n            --accent: #007AFF;\n            --warning: #FF9500;\n          }\n        }\n      </style>\n\n      <header>\n        <div class=\"header-content\">\n          <div class=\"logo\">\n            <svg width=\"32\" height=\"32\" viewBox=\"0 0 32 32\">\n              <rect width=\"32\" height=\"32\" rx=\"6\" fill=\"#000000\"/>\n              <text x=\"16\" y=\"16\" font-family=\"-apple-system, system-ui, sans-serif\" font-size=\"18\" font-weight=\"bold\" fill=\"#FFFFFF\" text-anchor=\"middle\" dominant-baseline=\"middle\">M</text>\n            </svg>\n          </div>\n          <div class=\"day-selector\">\n            <button class=\"day-btn active\" data-day=\"1\">Day 1</button>\n            <button class=\"day-btn\" data-day=\"2\">Day 2</button>\n            <button class=\"day-btn\" data-day=\"3\">Day 3</button>\n          </div>\n          <div class=\"header-actions\">\n            <update-indicator></update-indicator>\n          </div>\n        </div>\n      </header>\n\n      <main id=\"content\">\n      </main>\n\n      <div class=\"timer-bar\" id=\"timer-bar\">\n        <div class=\"timer-content\">\n          <div>\n            <div class=\"timer-display\" id=\"timer-display\">00:00</div>\n            <div class=\"timer-round\" id=\"timer-round\">Round 1/6</div>\n          </div>\n          <div class=\"timer-controls\">\n            <button class=\"timer-btn\" id=\"timer-toggle\">Start</button>\n            <button class=\"timer-btn pause\" id=\"timer-reset\">Reset</button>\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n  private setupEventListeners() {\n    if (!this.shadowRoot) return;\n\n    // Day selector\n    this.shadowRoot.querySelectorAll('.day-btn').forEach(btn => {\n      btn.addEventListener('click', (e) => {\n        const target = e.target as HTMLButtonElement;\n        const day = target.dataset.day;\n        if (day) {\n          this.selectDay(day);\n        }\n      });\n    });\n\n  }\n\n  private selectDay(day: string) {\n    if (!this.shadowRoot) return;\n    \n    this.shadowRoot.querySelectorAll('.day-btn').forEach(btn => {\n      btn.classList.remove('active');\n    });\n    \n    const selectedBtn = this.shadowRoot.querySelector(`.day-btn[data-day=\"${day}\"]`);\n    selectedBtn?.classList.add('active');\n    \n    this.dispatchEvent(new CustomEvent('day-selected', { detail: { day } }));\n  }\n\n  showTimer(display: string, round: string) {\n    if (!this.shadowRoot) return;\n    \n    const timerBar = this.shadowRoot.querySelector('#timer-bar');\n    const timerDisplay = this.shadowRoot.querySelector('#timer-display');\n    const timerRound = this.shadowRoot.querySelector('#timer-round');\n    \n    if (timerBar) timerBar.classList.add('active');\n    if (timerDisplay) timerDisplay.textContent = display;\n    if (timerRound) timerRound.textContent = round;\n  }\n\n  hideTimer() {\n    if (!this.shadowRoot) return;\n    \n    const timerBar = this.shadowRoot.querySelector('#timer-bar');\n    if (timerBar) timerBar.classList.remove('active');\n  }\n}\n\ncustomElements.define('app-shell', AppShell);","type StoreNames = 'programs' | 'days' | 'sessions';\n\nclass IDB {\n  private db: IDBDatabase | null = null;\n  private readonly dbName = 'minimalift_v1';\n  private readonly version = 1;\n\n  async openDb(): Promise<IDBDatabase> {\n    if (this.db) return this.db;\n\n    return new Promise((resolve, reject) => {\n      const request = indexedDB.open(this.dbName, this.version);\n\n      request.onerror = () => reject(request.error);\n      request.onsuccess = () => {\n        this.db = request.result;\n        resolve(this.db);\n      };\n\n      request.onupgradeneeded = (event) => {\n        const db = (event.target as IDBOpenDBRequest).result;\n\n        // Create programs store\n        if (!db.objectStoreNames.contains('programs')) {\n          db.createObjectStore('programs', { keyPath: 'programId' });\n        }\n\n        // Create days store with index\n        if (!db.objectStoreNames.contains('days')) {\n          const daysStore = db.createObjectStore('days', { keyPath: 'dayId' });\n          daysStore.createIndex('programId', 'programId', { unique: false });\n        }\n\n        // Create sessions store with indexes\n        if (!db.objectStoreNames.contains('sessions')) {\n          const sessionsStore = db.createObjectStore('sessions', { \n            keyPath: 'sessionId', \n            autoIncrement: true \n          });\n          sessionsStore.createIndex('dayId', 'dayId', { unique: false });\n          sessionsStore.createIndex('date', 'startedAt', { unique: false });\n        }\n      };\n    });\n  }\n\n  async tx(storeName: StoreNames, mode: IDBTransactionMode = 'readonly'): Promise<IDBObjectStore> {\n    const db = await this.openDb();\n    const transaction = db.transaction([storeName], mode);\n    return transaction.objectStore(storeName);\n  }\n\n  async get<T>(storeName: StoreNames, key: IDBValidKey): Promise<T | undefined> {\n    const store = await this.tx(storeName);\n    return new Promise((resolve, reject) => {\n      const request = store.get(key);\n      request.onsuccess = () => resolve(request.result);\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  async getAll<T>(storeName: StoreNames): Promise<T[]> {\n    const store = await this.tx(storeName);\n    return new Promise((resolve, reject) => {\n      const request = store.getAll();\n      request.onsuccess = () => resolve(request.result);\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  async put<T>(storeName: StoreNames, data: T): Promise<IDBValidKey> {\n    const store = await this.tx(storeName, 'readwrite');\n    return new Promise((resolve, reject) => {\n      const request = store.put(data);\n      request.onsuccess = () => resolve(request.result);\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  async delete(storeName: StoreNames, key: IDBValidKey): Promise<void> {\n    const store = await this.tx(storeName, 'readwrite');\n    return new Promise((resolve, reject) => {\n      const request = store.delete(key);\n      request.onsuccess = () => resolve();\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  async indexGetAll<T>(\n    storeName: StoreNames, \n    indexName: string, \n    query?: IDBValidKey | IDBKeyRange\n  ): Promise<T[]> {\n    const store = await this.tx(storeName);\n    const index = store.index(indexName);\n    return new Promise((resolve, reject) => {\n      const request = query ? index.getAll(query) : index.getAll();\n      request.onsuccess = () => resolve(request.result);\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  async clear(storeName: StoreNames): Promise<void> {\n    const store = await this.tx(storeName, 'readwrite');\n    return new Promise((resolve, reject) => {\n      const request = store.clear();\n      request.onsuccess = () => resolve();\n      request.onerror = () => reject(request.error);\n    });\n  }\n}\n\nexport const idb = new IDB();","import { idb } from './idb';\nimport { Program, Day, SeedData } from './types';\n\nexport class ProgramManager {\n  private static instance: ProgramManager;\n  \n  private constructor() {}\n  \n  static getInstance(): ProgramManager {\n    if (!ProgramManager.instance) {\n      ProgramManager.instance = new ProgramManager();\n    }\n    return ProgramManager.instance;\n  }\n\n  async initialize(): Promise<void> {\n    // Load seed data from TypeScript module\n    const { seedData } = await import('./data/seed-data');\n    \n    // Check if data already exists\n    const existingProgram = await idb.get<Program>('programs', seedData.programId);\n    \n    if (!existingProgram) {\n      await this.loadSeedData(seedData);\n    }\n  }\n\n  private async loadSeedData(seedData: SeedData): Promise<void> {\n    // Load program\n    const program: Program = {\n      programId: seedData.programId,\n      title: seedData.title\n    };\n    await idb.put('programs', program);\n\n    // Load days\n    for (const day of seedData.days) {\n      await idb.put('days', day);\n    }\n    \n    console.log('Seed data loaded successfully');\n  }\n\n  async getProgram(programId: string): Promise<Program | undefined> {\n    return await idb.get<Program>('programs', programId);\n  }\n\n  async getDaysForProgram(programId: string): Promise<Day[]> {\n    return await idb.indexGetAll<Day>('days', 'programId', programId);\n  }\n\n  async getDay(dayId: string): Promise<Day | undefined> {\n    return await idb.get<Day>('days', dayId);\n  }\n\n  async getAllDays(): Promise<Day[]> {\n    const days = await idb.getAll<Day>('days');\n    return days.sort((a, b) => a.order - b.order);\n  }\n}\n\nexport const programManager = ProgramManager.getInstance();","import { Day } from '../types';\nimport { programManager } from '../program';\n\nexport class ViewHome extends HTMLElement {\n  private days: Day[] = [];\n\n  constructor() {\n    super();\n    this.attachShadow({ mode: 'open' });\n  }\n\n  async connectedCallback() {\n    this.days = await programManager.getAllDays();\n    this.render();\n  }\n\n  private render() {\n    if (!this.shadowRoot) return;\n\n    this.shadowRoot.innerHTML = `\n      <style>\n        :host {\n          display: block;\n          padding: 16px;\n        }\n\n        h1 {\n          font-size: 28px;\n          font-weight: 700;\n          margin: 0 0 8px 0;\n          color: var(--text-primary);\n        }\n\n        .subtitle {\n          font-size: 16px;\n          color: var(--text-secondary);\n          margin-bottom: 32px;\n        }\n\n        .day-cards {\n          display: flex;\n          flex-direction: column;\n          gap: 16px;\n        }\n\n        .day-card {\n          background: var(--bg-secondary);\n          border-radius: 12px;\n          padding: 20px;\n          cursor: pointer;\n          border: 2px solid transparent;\n          transition: all 0.2s;\n        }\n\n        .day-card:hover {\n          border-color: var(--accent);\n          transform: translateY(-2px);\n        }\n\n        .day-number {\n          display: inline-block;\n          width: 32px;\n          height: 32px;\n          background: var(--accent);\n          color: white;\n          border-radius: 8px;\n          text-align: center;\n          line-height: 32px;\n          font-weight: 600;\n          margin-bottom: 12px;\n        }\n\n        .day-title {\n          font-size: 18px;\n          font-weight: 600;\n          color: var(--text-primary);\n          margin-bottom: 8px;\n        }\n\n        .day-summary {\n          font-size: 14px;\n          color: var(--text-secondary);\n          line-height: 1.5;\n        }\n\n        .day-blocks {\n          display: flex;\n          gap: 8px;\n          margin-top: 12px;\n          flex-wrap: wrap;\n        }\n\n        .block-badge {\n          background: var(--bg-primary);\n          color: var(--text-secondary);\n          padding: 4px 8px;\n          border-radius: 12px;\n          font-size: 11px;\n          font-weight: 500;\n          text-transform: uppercase;\n          letter-spacing: 0.5px;\n        }\n\n        :host {\n          --bg-primary: #000000;\n          --bg-secondary: #1a1a1a;\n          --text-primary: #ffffff;\n          --text-secondary: #999999;\n          --border: #333333;\n          --accent: #007AFF;\n        }\n\n        @media (prefers-color-scheme: light) {\n          :host {\n            --bg-primary: #ffffff;\n            --bg-secondary: #f5f5f5;\n            --text-primary: #000000;\n            --text-secondary: #666666;\n            --border: #e0e0e0;\n            --accent: #007AFF;\n          }\n        }\n      </style>\n\n      <h1>Minimalift</h1>\n      <div class=\"subtitle\">3-Day Full Body Program</div>\n      \n      <div class=\"day-cards\">\n        ${this.days.map(day => this.renderDayCard(day)).join('')}\n      </div>\n    `;\n\n    // Add click handlers\n    this.shadowRoot.querySelectorAll('.day-card').forEach(card => {\n      card.addEventListener('click', (e) => {\n        const dayId = (e.currentTarget as HTMLElement).dataset.dayId;\n        if (dayId) {\n          this.dispatchEvent(new CustomEvent('navigate-to-day', {\n            detail: { dayId },\n            bubbles: true,\n            composed: true\n          }));\n        }\n      });\n    });\n  }\n\n  private renderDayCard(day: Day): string {\n    const blockTypes = [...new Set(day.blocks.map(b => b.type))];\n    const exerciseCount = day.blocks.reduce((sum, block) => sum + block.exercises.length, 0);\n\n    return `\n      <div class=\"day-card\" data-day-id=\"${day.dayId}\">\n        <div class=\"day-number\">${day.order}</div>\n        <div class=\"day-title\">${day.title}</div>\n        <div class=\"day-summary\">${exerciseCount} exercises  ${day.blocks.length} blocks</div>\n        \n        <div class=\"day-blocks\">\n          ${blockTypes.map(type => `<span class=\"block-badge\">${type}</span>`).join('')}\n        </div>\n      </div>\n    `;\n  }\n}\n\ncustomElements.define('view-home', ViewHome);","import { Day, Block, Exercise } from '../types';\nimport { programManager } from '../program';\n\nexport class ViewDay extends HTMLElement {\n  private day: Day | null = null;\n\n  constructor() {\n    super();\n    this.attachShadow({ mode: 'open' });\n  }\n\n  async loadDay(dayId: string) {\n    this.day = await programManager.getDay(dayId) || null;\n    this.render();\n  }\n\n  private render() {\n    if (!this.shadowRoot) return;\n\n    if (!this.day) {\n      this.shadowRoot.innerHTML = '<p>Loading...</p>';\n      return;\n    }\n\n    this.shadowRoot.innerHTML = `\n      <style>\n        :host {\n          display: block;\n          padding: 16px;\n          padding-bottom: 120px; /* Extra space for fixed button */\n          box-sizing: border-box;\n        }\n\n        h2 {\n          font-size: 24px;\n          font-weight: 600;\n          margin: 0 0 24px 0;\n          color: var(--text-primary);\n        }\n\n        .block {\n          margin-bottom: 32px;\n          background: var(--bg-secondary);\n          border-radius: 12px;\n          padding: 16px;\n        }\n\n        .block-header {\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          margin-bottom: 16px;\n        }\n\n        .block-title {\n          font-size: 14px;\n          font-weight: 600;\n          text-transform: uppercase;\n          letter-spacing: 0.5px;\n          color: var(--text-secondary);\n        }\n\n        .timer-badge {\n          background: var(--accent);\n          color: white;\n          padding: 4px 8px;\n          border-radius: 4px;\n          font-size: 12px;\n          font-weight: 500;\n        }\n\n        .exercise {\n          background: var(--bg-primary);\n          border-radius: 8px;\n          padding: 12px;\n          margin-bottom: 8px;\n        }\n\n        .exercise:last-child {\n          margin-bottom: 0;\n        }\n\n        .exercise-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 8px;\n        }\n\n        .exercise-name {\n          font-size: 16px;\n          font-weight: 500;\n          color: var(--text-primary);\n        }\n\n        .exercise-sets-reps {\n          font-size: 14px;\n          color: var(--accent);\n          font-weight: 500;\n        }\n\n        .exercise-cues {\n          font-size: 13px;\n          color: var(--text-secondary);\n          line-height: 1.4;\n          margin-top: 4px;\n        }\n\n        .substitutes {\n          display: flex;\n          gap: 8px;\n          margin-top: 8px;\n          flex-wrap: wrap;\n        }\n\n        .substitute-chip {\n          background: var(--bg-secondary);\n          color: var(--text-secondary);\n          padding: 4px 8px;\n          border-radius: 12px;\n          font-size: 12px;\n          border: 1px solid var(--border);\n          cursor: pointer;\n        }\n\n        .substitute-chip:hover {\n          background: var(--accent);\n          color: white;\n          border-color: var(--accent);\n        }\n\n        .block-notes {\n          background: var(--bg-primary);\n          border-radius: 8px;\n          padding: 12px;\n          margin-top: 12px;\n          font-size: 13px;\n          color: var(--text-secondary);\n          line-height: 1.5;\n        }\n\n        .start-session-btn {\n          position: fixed;\n          bottom: 24px;\n          left: 50%;\n          transform: translateX(-50%);\n          background: var(--accent);\n          color: white;\n          border: none;\n          padding: 16px 32px;\n          border-radius: 24px;\n          font-size: 16px;\n          font-weight: 600;\n          cursor: pointer;\n          box-shadow: 0 4px 12px rgba(0, 122, 255, 0.3);\n          z-index: 100;\n        }\n\n        :host {\n          --bg-primary: #000000;\n          --bg-secondary: #1a1a1a;\n          --text-primary: #ffffff;\n          --text-secondary: #999999;\n          --border: #333333;\n          --accent: #007AFF;\n        }\n\n        @media (prefers-color-scheme: light) {\n          :host {\n            --bg-primary: #ffffff;\n            --bg-secondary: #f5f5f5;\n            --text-primary: #000000;\n            --text-secondary: #666666;\n            --border: #e0e0e0;\n            --accent: #007AFF;\n          }\n        }\n      </style>\n\n      <h2>${this.day.title}</h2>\n      \n      ${this.day.blocks.map(block => this.renderBlock(block)).join('')}\n      \n      <button class=\"start-session-btn\" data-day-id=\"${this.day.dayId}\">\n        Start Session\n      </button>\n    `;\n\n    // Add event listeners\n    this.shadowRoot.querySelector('.start-session-btn')?.addEventListener('click', (e) => {\n      const btn = e.target as HTMLButtonElement;\n      const dayId = btn.dataset.dayId;\n      if (dayId) {\n        this.dispatchEvent(new CustomEvent('start-session', { \n          detail: { dayId },\n          bubbles: true,\n          composed: true\n        }));\n      }\n    });\n\n    // Add substitute click handlers\n    this.shadowRoot.querySelectorAll('.substitute-chip').forEach(chip => {\n      chip.addEventListener('click', (e) => {\n        const el = e.target as HTMLElement;\n        const exerciseId = el.dataset.exerciseId;\n        const substitute = el.dataset.substitute;\n        if (exerciseId && substitute) {\n          console.log('Switch to substitute:', substitute, 'for exercise:', exerciseId);\n          // TODO: Implement substitute switching\n        }\n      });\n    });\n  }\n\n  private renderBlock(block: Block): string {\n    const timerLabel = this.getTimerLabel(block.timerType);\n    \n    return `\n      <div class=\"block\">\n        <div class=\"block-header\">\n          <span class=\"block-title\">${this.getBlockTitle(block.type)}</span>\n          ${timerLabel ? `<span class=\"timer-badge\">${timerLabel}</span>` : ''}\n        </div>\n        \n        ${block.exercises.map(exercise => this.renderExercise(exercise)).join('')}\n        \n        ${block.notes ? `<div class=\"block-notes\">${block.notes}</div>` : ''}\n      </div>\n    `;\n  }\n\n  private renderExercise(exercise: Exercise): string {\n    const setsReps = exercise.sets ? `${exercise.sets}  ${exercise.reps}` : exercise.reps;\n    \n    return `\n      <div class=\"exercise\">\n        <div class=\"exercise-header\">\n          <span class=\"exercise-name\">${exercise.name}</span>\n          <span class=\"exercise-sets-reps\">${setsReps}</span>\n        </div>\n        \n        ${exercise.cues ? `<div class=\"exercise-cues\">${exercise.cues}</div>` : ''}\n        \n        ${exercise.substitutes && exercise.substitutes.length > 0 ? `\n          <div class=\"substitutes\">\n            ${exercise.substitutes.map(sub => `\n              <span class=\"substitute-chip\" \n                    data-exercise-id=\"${exercise.id}\" \n                    data-substitute=\"${sub}\">\n                ${sub}\n              </span>\n            `).join('')}\n          </div>\n        ` : ''}\n      </div>\n    `;\n  }\n\n  private getBlockTitle(type: string): string {\n    const titles: Record<string, string> = {\n      warmup: 'Warm Up',\n      strength: 'Strength & Condition',\n      swole: 'Swole & Flexy',\n      accessory: 'Accessories'\n    };\n    return titles[type] || type;\n  }\n\n  private getTimerLabel(timerType: string): string {\n    const labels: Record<string, string> = {\n      interval: 'Interval',\n      work_rest: 'Work/Rest',\n      circuit: 'Circuit',\n      tabata: 'Tabata',\n      stopwatch: 'Stopwatch',\n      none: ''\n    };\n    return labels[timerType] || '';\n  }\n}\n\ncustomElements.define('view-day', ViewDay);","export type TimerState = 'idle' | 'running' | 'paused' | 'completed';\n\nexport interface TimerEvent {\n  type: 'tick' | 'roundComplete' | 'complete' | 'stateChange';\n  elapsed: number;\n  remaining: number;\n  round?: number;\n  totalRounds?: number;\n  state: TimerState;\n}\n\nexport type TimerCallback = (event: TimerEvent) => void;\n\nexport abstract class BaseTimer {\n  protected startTime: number = 0;\n  protected pausedTime: number = 0;\n  protected totalPausedDuration: number = 0;\n  protected intervalId: number | null = null;\n  protected state: TimerState = 'idle';\n  protected callbacks: TimerCallback[] = [];\n\n  constructor(protected readonly tickInterval: number = 100) {}\n\n  abstract getDuration(): number;\n  abstract getCurrentRound(): number;\n  abstract getTotalRounds(): number;\n  abstract getTimeInCurrentPeriod(): number;\n  abstract getRemainingInCurrentPeriod(): number;\n\n  start(): void {\n    if (this.state === 'running') return;\n\n    if (this.state === 'paused') {\n      // Resume from pause\n      this.totalPausedDuration += performance.now() - this.pausedTime;\n    } else {\n      // Fresh start\n      this.startTime = performance.now();\n      this.totalPausedDuration = 0;\n    }\n\n    this.state = 'running';\n    this.intervalId = window.setInterval(() => this.tick(), this.tickInterval);\n    this.notifyStateChange();\n  }\n\n  pause(): void {\n    if (this.state !== 'running') return;\n\n    this.state = 'paused';\n    this.pausedTime = performance.now();\n    \n    if (this.intervalId) {\n      clearInterval(this.intervalId);\n      this.intervalId = null;\n    }\n    \n    this.notifyStateChange();\n  }\n\n  reset(): void {\n    this.stop();\n    this.state = 'idle';\n    this.startTime = 0;\n    this.pausedTime = 0;\n    this.totalPausedDuration = 0;\n    this.notifyStateChange();\n  }\n\n  stop(): void {\n    if (this.intervalId) {\n      clearInterval(this.intervalId);\n      this.intervalId = null;\n    }\n  }\n\n  getState(): TimerState {\n    return this.state;\n  }\n\n  getElapsedTime(): number {\n    if (this.startTime === 0) return 0;\n\n    const now = this.state === 'paused' ? this.pausedTime : performance.now();\n    return now - this.startTime - this.totalPausedDuration;\n  }\n\n  addCallback(callback: TimerCallback): void {\n    this.callbacks.push(callback);\n  }\n\n  removeCallback(callback: TimerCallback): void {\n    const index = this.callbacks.indexOf(callback);\n    if (index > -1) {\n      this.callbacks.splice(index, 1);\n    }\n  }\n\n  protected tick(): void {\n    const elapsed = this.getElapsedTime();\n    const remainingInPeriod = this.getRemainingInCurrentPeriod();\n    const currentRound = this.getCurrentRound();\n    const totalRounds = this.getTotalRounds();\n\n    // Check if timer is complete with tolerance to avoid display/completion mismatch\n    const duration = this.getDuration();\n    if (elapsed >= duration - 100) { // 100ms tolerance\n      this.state = 'completed';\n      this.stop();\n      \n      this.notifyCallbacks({\n        type: 'complete',\n        elapsed: duration,\n        remaining: 0,\n        round: currentRound,\n        totalRounds,\n        state: this.state\n      });\n      return;\n    }\n\n    // Check for round completion (depends on timer type)\n    const previousRound = this.getPreviousRound(elapsed - this.tickInterval);\n    if (currentRound > previousRound && previousRound > 0) {\n      this.notifyCallbacks({\n        type: 'roundComplete',\n        elapsed,\n        remaining: remainingInPeriod,\n        round: previousRound,\n        totalRounds,\n        state: this.state\n      });\n    }\n\n    // Regular tick update\n    this.notifyCallbacks({\n      type: 'tick',\n      elapsed,\n      remaining: remainingInPeriod,\n      round: currentRound,\n      totalRounds,\n      state: this.state\n    });\n  }\n\n  protected abstract getPreviousRound(elapsed: number): number;\n\n  protected notifyCallbacks(event: TimerEvent): void {\n    this.callbacks.forEach(callback => {\n      try {\n        callback(event);\n      } catch (error) {\n        console.error('Timer callback error:', error);\n      }\n    });\n  }\n\n  protected notifyStateChange(): void {\n    const elapsed = this.getElapsedTime();\n    this.notifyCallbacks({\n      type: 'stateChange',\n      elapsed,\n      remaining: this.getRemainingInCurrentPeriod(),\n      round: this.getCurrentRound(),\n      totalRounds: this.getTotalRounds(),\n      state: this.state\n    });\n  }\n\n  // Utility methods for time formatting\n  static formatTime(milliseconds: number): string {\n    // When very close to 0, show 0 instead of rounding up to 1\n    const totalSeconds = milliseconds <= 100 ? 0 : Math.max(0, Math.ceil(milliseconds / 1000));\n    const minutes = Math.floor(totalSeconds / 60);\n    const seconds = totalSeconds % 60;\n    return `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;\n  }\n\n  static formatTimeWithMs(milliseconds: number): string {\n    const totalMs = Math.max(0, milliseconds);\n    const seconds = Math.floor(totalMs / 1000);\n    const ms = Math.floor((totalMs % 1000) / 100);\n    const minutes = Math.floor(seconds / 60);\n    const remainingSeconds = seconds % 60;\n    return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}.${ms}`;\n  }\n}","import { BaseTimer } from './timer-engine';\n\nexport class IntervalTimer extends BaseTimer {\n  private currentRound: number = 1;\n  \n  constructor(\n    private intervalSec: number,\n    private totalRounds: number,\n    private exercisesPerInterval: number = 1\n  ) {\n    super();\n  }\n\n  getDuration(): number {\n    return this.intervalSec * this.totalRounds * 1000;\n  }\n\n  getCurrentRound(): number {\n    const elapsed = this.getElapsedTime();\n    return Math.min(Math.floor(elapsed / (this.intervalSec * 1000)) + 1, this.totalRounds);\n  }\n\n  getTotalRounds(): number {\n    return this.totalRounds;\n  }\n\n  getTimeInCurrentPeriod(): number {\n    const elapsed = this.getElapsedTime();\n    return elapsed % (this.intervalSec * 1000);\n  }\n\n  getRemainingInCurrentPeriod(): number {\n    return (this.intervalSec * 1000) - this.getTimeInCurrentPeriod();\n  }\n\n  getExercisesPerInterval(): number {\n    return this.exercisesPerInterval;\n  }\n\n  protected getPreviousRound(elapsed: number): number {\n    return Math.min(Math.floor(elapsed / (this.intervalSec * 1000)) + 1, this.totalRounds);\n  }\n\n  protected tick(): void {\n    const elapsed = this.getElapsedTime();\n    const remaining = this.getDuration() - elapsed;\n    const currentRound = this.getCurrentRound();\n\n    if (remaining <= 0) {\n      this.state = 'completed';\n      this.stop();\n      this.notifyCallbacks({\n        type: 'complete',\n        elapsed,\n        remaining,\n        round: currentRound,\n        totalRounds: this.totalRounds,\n        state: this.state\n      });\n      return;\n    }\n\n    if (currentRound > this.currentRound) {\n      this.currentRound = currentRound;\n      this.notifyCallbacks({\n        type: 'roundComplete',\n        elapsed,\n        remaining,\n        round: currentRound - 1,\n        totalRounds: this.totalRounds,\n        state: this.state\n      });\n    }\n\n    this.notifyCallbacks({\n      type: 'tick',\n      elapsed,\n      remaining,\n      round: currentRound,\n      totalRounds: this.totalRounds,\n      state: this.state\n    });\n  }\n}","import { BaseTimer } from './timer-engine';\n\nexport class WorkRestTimer extends BaseTimer {\n  private currentSet: number = 1;\n  private isWorkPhase: boolean = true;\n  \n  constructor(\n    private workSec: number,\n    private restSec: number,\n    private totalSets: number\n  ) {\n    super();\n  }\n\n  getDuration(): number {\n    return (this.workSec + this.restSec) * this.totalSets * 1000;\n  }\n\n  getCurrentRound(): number {\n    return this.currentSet;\n  }\n\n  getTotalRounds(): number {\n    return this.totalSets;\n  }\n\n  getTimeInCurrentPeriod(): number {\n    const elapsed = this.getElapsedTime();\n    const periodDuration = (this.workSec + this.restSec) * 1000;\n    const timeInSet = elapsed % periodDuration;\n    \n    if (timeInSet < this.workSec * 1000) {\n      return timeInSet;\n    } else {\n      return timeInSet - (this.workSec * 1000);\n    }\n  }\n\n  getRemainingInCurrentPeriod(): number {\n    const elapsed = this.getElapsedTime();\n    const periodDuration = (this.workSec + this.restSec) * 1000;\n    const timeInSet = elapsed % periodDuration;\n    \n    if (timeInSet < this.workSec * 1000) {\n      return (this.workSec * 1000) - timeInSet;\n    } else {\n      return (this.restSec * 1000) - (timeInSet - this.workSec * 1000);\n    }\n  }\n\n  isInWorkPhase(): boolean {\n    const elapsed = this.getElapsedTime();\n    const periodDuration = (this.workSec + this.restSec) * 1000;\n    const timeInSet = elapsed % periodDuration;\n    return timeInSet < this.workSec * 1000;\n  }\n\n  protected getPreviousRound(elapsed: number): number {\n    return Math.min(Math.floor(elapsed / ((this.workSec + this.restSec) * 1000)) + 1, this.totalSets);\n  }\n\n  protected tick(): void {\n    const elapsed = this.getElapsedTime();\n    const remaining = this.getDuration() - elapsed;\n    const currentSet = Math.min(Math.floor(elapsed / ((this.workSec + this.restSec) * 1000)) + 1, this.totalSets);\n    const wasWorkPhase = this.isWorkPhase;\n    this.isWorkPhase = this.isInWorkPhase();\n\n    // Check for completion with a small tolerance to avoid display/completion mismatch\n    if (remaining <= 100) { // 100ms tolerance\n      this.state = 'completed';\n      this.stop();\n      \n      this.notifyCallbacks({\n        type: 'complete',\n        elapsed: this.getDuration(),\n        remaining: 0,\n        round: this.totalSets,\n        totalRounds: this.totalSets,\n        state: this.state\n      });\n      return;\n    }\n\n    if (currentSet > this.currentSet) {\n      this.currentSet = currentSet;\n      this.notifyCallbacks({\n        type: 'roundComplete',\n        elapsed,\n        remaining,\n        round: currentSet - 1,\n        totalRounds: this.totalSets,\n        state: this.state\n      });\n    } else if (wasWorkPhase && !this.isWorkPhase) {\n      // Transitioned from work to rest\n      this.notifyCallbacks({\n        type: 'tick',\n        elapsed,\n        remaining,\n        round: currentSet,\n        totalRounds: this.totalSets,\n        state: this.state\n      });\n    }\n\n    this.notifyCallbacks({\n      type: 'tick',\n      elapsed,\n      remaining,\n      round: currentSet,\n      totalRounds: this.totalSets,\n      state: this.state\n    });\n  }\n}","import { BaseTimer } from './timer-engine';\n\nexport interface Station {\n  name: string;\n  durationSec: number;\n}\n\nexport class CircuitTimer extends BaseTimer {\n  private currentRound: number = 1;\n  private currentStationIndex: number = 0;\n  \n  constructor(\n    private stations: Station[],\n    private totalRounds: number,\n    private transitionSec: number = 0\n  ) {\n    super();\n  }\n\n  getDuration(): number {\n    const stationTime = this.stations.reduce((sum, s) => sum + s.durationSec, 0);\n    const transitionTime = this.transitionSec * Math.max(0, this.stations.length - 1);\n    return (stationTime + transitionTime) * this.totalRounds * 1000;\n  }\n\n  getCurrentRound(): number {\n    return this.currentRound;\n  }\n\n  getTotalRounds(): number {\n    return this.totalRounds;\n  }\n\n  getCurrentStation(): Station | null {\n    if (this.currentStationIndex < this.stations.length) {\n      return this.stations[this.currentStationIndex];\n    }\n    return null;\n  }\n\n  getCurrentStationIndex(): number {\n    return this.currentStationIndex;\n  }\n\n  getTimeInCurrentPeriod(): number {\n    const elapsed = this.getElapsedTime();\n    const roundDuration = this.getRoundDuration();\n    const timeInRound = elapsed % roundDuration;\n    \n    let accumulated = 0;\n    for (let i = 0; i < this.stations.length; i++) {\n      const stationDuration = this.stations[i].durationSec * 1000;\n      if (timeInRound < accumulated + stationDuration) {\n        return timeInRound - accumulated;\n      }\n      accumulated += stationDuration;\n      \n      if (i < this.stations.length - 1) {\n        const transitionDuration = this.transitionSec * 1000;\n        if (timeInRound < accumulated + transitionDuration) {\n          return timeInRound - accumulated;\n        }\n        accumulated += transitionDuration;\n      }\n    }\n    \n    return 0;\n  }\n\n  getRemainingInCurrentPeriod(): number {\n    const station = this.getCurrentStation();\n    if (!station) return 0;\n    \n    const isTransition = this.isInTransition();\n    const periodDuration = isTransition ? this.transitionSec * 1000 : station.durationSec * 1000;\n    return periodDuration - this.getTimeInCurrentPeriod();\n  }\n\n  isInTransition(): boolean {\n    const elapsed = this.getElapsedTime();\n    const roundDuration = this.getRoundDuration();\n    const timeInRound = elapsed % roundDuration;\n    \n    let accumulated = 0;\n    for (let i = 0; i < this.stations.length; i++) {\n      accumulated += this.stations[i].durationSec * 1000;\n      if (timeInRound < accumulated) {\n        return false;\n      }\n      \n      if (i < this.stations.length - 1) {\n        accumulated += this.transitionSec * 1000;\n        if (timeInRound < accumulated) {\n          return true;\n        }\n      }\n    }\n    \n    return false;\n  }\n\n  private getRoundDuration(): number {\n    const stationTime = this.stations.reduce((sum, s) => sum + s.durationSec * 1000, 0);\n    const transitionTime = this.transitionSec * Math.max(0, this.stations.length - 1) * 1000;\n    return stationTime + transitionTime;\n  }\n\n  private updateCurrentPosition(): void {\n    const elapsed = this.getElapsedTime();\n    const roundDuration = this.getRoundDuration();\n    \n    this.currentRound = Math.min(Math.floor(elapsed / roundDuration) + 1, this.totalRounds);\n    const timeInRound = elapsed % roundDuration;\n    \n    let accumulated = 0;\n    for (let i = 0; i < this.stations.length; i++) {\n      accumulated += this.stations[i].durationSec * 1000;\n      if (timeInRound < accumulated) {\n        this.currentStationIndex = i;\n        return;\n      }\n      \n      if (i < this.stations.length - 1) {\n        accumulated += this.transitionSec * 1000;\n        if (timeInRound < accumulated) {\n          this.currentStationIndex = i;\n          return;\n        }\n      }\n    }\n    \n    this.currentStationIndex = this.stations.length - 1;\n  }\n\n  protected getPreviousRound(elapsed: number): number {\n    const roundDuration = this.getRoundDuration();\n    return Math.min(Math.floor(elapsed / roundDuration) + 1, this.totalRounds);\n  }\n\n  protected tick(): void {\n    const elapsed = this.getElapsedTime();\n    const remaining = this.getDuration() - elapsed;\n    \n    if (remaining <= 0) {\n      this.state = 'completed'; this.stop();\n      return;\n    }\n\n    const prevRound = this.currentRound;\n    // const prevStation = this.currentStationIndex;\n    this.updateCurrentPosition();\n\n    if (this.currentRound > prevRound) {\n      this.notifyCallbacks({\n        type: 'roundComplete',\n        elapsed,\n        remaining,\n        round: prevRound,\n        totalRounds: this.totalRounds,\n        state: this.state\n      });\n    }\n\n    this.notifyCallbacks({\n      type: 'tick',\n      elapsed,\n      remaining,\n      round: this.currentRound,\n      totalRounds: this.totalRounds,\n      state: this.state\n    });\n  }\n}","import { BaseTimer } from './timer-engine';\n\nexport class TabataTimer extends BaseTimer {\n  private currentRound: number = 1;\n  \n  constructor(\n    private highIntensitySec: number,\n    private lowIntensitySec: number,\n    private totalRounds: number\n  ) {\n    super();\n  }\n\n  getDuration(): number {\n    return (this.highIntensitySec + this.lowIntensitySec) * this.totalRounds * 1000;\n  }\n\n  getCurrentRound(): number {\n    const elapsed = this.getElapsedTime();\n    const periodDuration = (this.highIntensitySec + this.lowIntensitySec) * 1000;\n    return Math.min(Math.floor(elapsed / periodDuration) + 1, this.totalRounds);\n  }\n\n  getTotalRounds(): number {\n    return this.totalRounds;\n  }\n\n  getTimeInCurrentPeriod(): number {\n    const elapsed = this.getElapsedTime();\n    const periodDuration = (this.highIntensitySec + this.lowIntensitySec) * 1000;\n    const timeInRound = elapsed % periodDuration;\n    \n    if (timeInRound < this.highIntensitySec * 1000) {\n      return timeInRound;\n    } else {\n      return timeInRound - (this.highIntensitySec * 1000);\n    }\n  }\n\n  getRemainingInCurrentPeriod(): number {\n    const elapsed = this.getElapsedTime();\n    const periodDuration = (this.highIntensitySec + this.lowIntensitySec) * 1000;\n    const timeInRound = elapsed % periodDuration;\n    \n    if (timeInRound < this.highIntensitySec * 1000) {\n      return (this.highIntensitySec * 1000) - timeInRound;\n    } else {\n      return (this.lowIntensitySec * 1000) - (timeInRound - this.highIntensitySec * 1000);\n    }\n  }\n\n  isHighIntensity(): boolean {\n    const elapsed = this.getElapsedTime();\n    const periodDuration = (this.highIntensitySec + this.lowIntensitySec) * 1000;\n    const timeInRound = elapsed % periodDuration;\n    return timeInRound < this.highIntensitySec * 1000;\n  }\n\n  protected getPreviousRound(elapsed: number): number {\n    const periodDuration = (this.highIntensitySec + this.lowIntensitySec) * 1000;\n    return Math.min(Math.floor(elapsed / periodDuration) + 1, this.totalRounds);\n  }\n\n  protected tick(): void {\n    const elapsed = this.getElapsedTime();\n    const remaining = this.getDuration() - elapsed;\n    const currentRound = this.getCurrentRound();\n\n    if (remaining <= 0) {\n      this.state = 'completed'; this.stop();\n      return;\n    }\n\n    if (currentRound > this.currentRound) {\n      this.currentRound = currentRound;\n      this.notifyCallbacks({\n        type: 'roundComplete',\n        elapsed,\n        remaining,\n        round: currentRound - 1,\n        totalRounds: this.totalRounds,\n        state: this.state\n      });\n    }\n\n    this.notifyCallbacks({\n      type: 'tick',\n      elapsed,\n      remaining,\n      round: currentRound,\n      totalRounds: this.totalRounds,\n      state: this.state\n    });\n  }\n}","import { BaseTimer } from './timer-engine';\n\nexport class StopwatchTimer extends BaseTimer {\n  private laps: number[] = [];\n  \n  constructor() {\n    super();\n  }\n\n  getDuration(): number {\n    // Stopwatch has no fixed duration\n    return Number.MAX_SAFE_INTEGER;\n  }\n\n  getCurrentRound(): number {\n    return this.laps.length + 1;\n  }\n\n  getTotalRounds(): number {\n    // No fixed number of rounds for stopwatch\n    return 0;\n  }\n\n  getTimeInCurrentPeriod(): number {\n    const elapsed = this.getElapsedTime();\n    const lastLapTime = this.laps.length > 0 ? this.laps[this.laps.length - 1] : 0;\n    return elapsed - lastLapTime;\n  }\n\n  getRemainingInCurrentPeriod(): number {\n    // Stopwatch doesn't have a remaining time\n    return 0;\n  }\n\n  addLap(): void {\n    const elapsed = this.getElapsedTime();\n    this.laps.push(elapsed);\n    \n    this.notifyCallbacks({\n      type: 'roundComplete',\n      elapsed,\n      remaining: 0,\n      round: this.laps.length,\n      totalRounds: 0,\n      state: this.state\n    });\n  }\n\n  getLaps(): number[] {\n    return [...this.laps];\n  }\n\n  getLapTime(index: number): number {\n    if (index < 0 || index >= this.laps.length) return 0;\n    \n    const lapTime = this.laps[index];\n    const previousLapTime = index > 0 ? this.laps[index - 1] : 0;\n    return lapTime - previousLapTime;\n  }\n\n  reset(): void {\n    super.reset();\n    this.laps = [];\n  }\n\n  protected getPreviousRound(_elapsed: number): number {\n    // Stopwatch doesn't have traditional rounds\n    return this.laps.length;\n  }\n\n  protected tick(): void {\n    const elapsed = this.getElapsedTime();\n    \n    this.notifyCallbacks({\n      type: 'tick',\n      elapsed,\n      remaining: 0,\n      round: this.laps.length + 1,\n      totalRounds: 0,\n      state: this.state\n    });\n  }\n}","import { TimerType, TimerConfig } from '../types';\nimport { BaseTimer } from './timer-engine';\nimport { IntervalTimer } from './interval';\nimport { WorkRestTimer } from './work-rest';\nimport { CircuitTimer } from './circuit';\nimport { TabataTimer } from './tabata';\nimport { StopwatchTimer } from './stopwatch';\n\nexport class TimerFactory {\n  static createTimer(type: TimerType, config?: TimerConfig): BaseTimer | null {\n    if (!config && type !== 'stopwatch') return null;\n\n    switch (type) {\n      case 'interval':\n        if (config?.intervalSec && config?.rounds) {\n          return new IntervalTimer(\n            config.intervalSec,\n            config.rounds,\n            config.exercisesPerInterval || 1\n          );\n        }\n        break;\n\n      case 'work_rest':\n        if (config?.workSec && config?.restSec && config?.rounds) {\n          return new WorkRestTimer(\n            config.workSec,\n            config.restSec,\n            config.rounds\n          );\n        } else if (config?.restSec && config?.rounds) {\n          // Simple rest timer (work phase is 0)\n          return new WorkRestTimer(\n            0,\n            config.restSec,\n            config.rounds\n          );\n        }\n        break;\n\n      case 'circuit':\n        if (config?.stations && config.stations.length > 0 && config?.rounds) {\n          return new CircuitTimer(\n            config.stations,\n            config.rounds,\n            config.transitionSec || 0\n          );\n        }\n        break;\n\n      case 'tabata':\n        if (config?.highIntensitySec && config?.lowIntensitySec && config?.rounds) {\n          return new TabataTimer(\n            config.highIntensitySec,\n            config.lowIntensitySec,\n            config.rounds\n          );\n        }\n        break;\n\n      case 'stopwatch':\n        return new StopwatchTimer();\n\n      case 'none':\n      default:\n        return null;\n    }\n\n    return null;\n  }\n\n  // Convenience method for creating rest timer between sets\n  static createRestTimer(restSeconds: number, sets: number = 1): WorkRestTimer {\n    return new WorkRestTimer(0, restSeconds, sets);\n  }\n}","/**\n * Wake Lock utility for keeping the screen active during workouts\n */\nexport class WakeLockManager {\n  private wakeLock: WakeLockSentinel | null = null;\n  private supported = 'wakeLock' in navigator;\n\n  /**\n   * Request a wake lock to prevent screen from sleeping\n   */\n  async acquire(): Promise<boolean> {\n    if (!this.supported) {\n      console.warn('Wake Lock API not supported');\n      return false;\n    }\n\n    try {\n      if (this.wakeLock) {\n        // Already have an active wake lock\n        return true;\n      }\n\n      this.wakeLock = await (navigator as any).wakeLock.request('screen');\n      \n      this.wakeLock?.addEventListener('release', () => {\n        console.log('Wake lock released');\n        this.wakeLock = null;\n      });\n\n      console.log('Wake lock acquired');\n      return true;\n    } catch (err) {\n      console.error('Failed to acquire wake lock:', err);\n      return false;\n    }\n  }\n\n  /**\n   * Release the current wake lock\n   */\n  async release(): Promise<void> {\n    if (this.wakeLock) {\n      try {\n        await this.wakeLock.release();\n        this.wakeLock = null;\n        console.log('Wake lock released manually');\n      } catch (err) {\n        console.error('Failed to release wake lock:', err);\n      }\n    }\n  }\n\n  /**\n   * Check if wake lock is currently active\n   */\n  isActive(): boolean {\n    return this.wakeLock !== null && !this.wakeLock.released;\n  }\n\n  /**\n   * Check if wake lock API is supported\n   */\n  isSupportedApi(): boolean {\n    return this.supported;\n  }\n\n  /**\n   * Re-acquire wake lock if it was lost (e.g., after tab became inactive)\n   */\n  async reacquire(): Promise<boolean> {\n    if (this.wakeLock && this.wakeLock.released) {\n      this.wakeLock = null;\n      return await this.acquire();\n    }\n    return this.isActive();\n  }\n}\n\nexport const wakeLockManager = new WakeLockManager();","/**\n * Background timer management to handle app going background/foreground\n */\nexport class BackgroundTimerManager {\n  private backgroundStartTime: number | null = null;\n  private callbacks: (() => void)[] = [];\n\n  constructor() {\n    this.setupVisibilityHandlers();\n  }\n\n  private setupVisibilityHandlers() {\n    document.addEventListener('visibilitychange', () => {\n      if (document.hidden) {\n        this.handleBackground();\n      } else {\n        this.handleForeground();\n      }\n    });\n\n    // Also handle page focus/blur for better coverage\n    window.addEventListener('blur', () => {\n      if (!document.hidden) {\n        this.handleBackground();\n      }\n    });\n\n    window.addEventListener('focus', () => {\n      if (!document.hidden) {\n        this.handleForeground();\n      }\n    });\n  }\n\n  private handleBackground() {\n    console.log('App went to background');\n    this.backgroundStartTime = performance.now();\n    \n    // Show a notification if permissions are granted and we have an active timer\n    this.maybeShowNotification();\n  }\n\n  private handleForeground() {\n    if (this.backgroundStartTime !== null) {\n      const timeInBackground = performance.now() - this.backgroundStartTime;\n      console.log(`App returned to foreground after ${timeInBackground}ms`);\n      \n      this.backgroundStartTime = null;\n      \n      // Notify callbacks that we're back in foreground\n      this.callbacks.forEach(callback => {\n        try {\n          callback();\n        } catch (error) {\n          console.error('Background timer callback error:', error);\n        }\n      });\n    }\n  }\n\n  private async maybeShowNotification() {\n    // Check if we have notification permission\n    if ('Notification' in window && Notification.permission === 'granted') {\n      // Only show if we have an active workout session\n      const isSessionActive = this.callbacks.length > 0;\n      \n      if (isSessionActive) {\n        try {\n          const notification = new Notification('Minimalift Workout Active', {\n            body: 'Your workout timer is still running in the background.',\n            icon: '/icons/icon-192x192.png',\n            badge: '/icons/icon-192x192.png',\n            tag: 'workout-active',\n            requireInteraction: false,\n            silent: true\n          });\n\n          // Auto-close after 5 seconds\n          setTimeout(() => notification.close(), 5000);\n        } catch (error) {\n          console.error('Failed to show notification:', error);\n        }\n      }\n    }\n  }\n\n  /**\n   * Add a callback to be notified when app returns to foreground\n   */\n  addForegroundCallback(callback: () => void) {\n    this.callbacks.push(callback);\n  }\n\n  /**\n   * Remove a foreground callback\n   */\n  removeForegroundCallback(callback: () => void) {\n    const index = this.callbacks.indexOf(callback);\n    if (index > -1) {\n      this.callbacks.splice(index, 1);\n    }\n  }\n\n  /**\n   * Get time spent in background (if currently in background)\n   */\n  getTimeInBackground(): number {\n    if (this.backgroundStartTime !== null) {\n      return performance.now() - this.backgroundStartTime;\n    }\n    return 0;\n  }\n\n  /**\n   * Check if app is currently in background\n   */\n  isInBackground(): boolean {\n    return document.hidden;\n  }\n\n  /**\n   * Request notification permission if not already granted\n   */\n  async requestNotificationPermission(): Promise<boolean> {\n    if (!('Notification' in window)) {\n      console.warn('Notifications not supported');\n      return false;\n    }\n\n    if (Notification.permission === 'granted') {\n      return true;\n    }\n\n    if (Notification.permission === 'denied') {\n      return false;\n    }\n\n    try {\n      const permission = await Notification.requestPermission();\n      return permission === 'granted';\n    } catch (error) {\n      console.error('Failed to request notification permission:', error);\n      return false;\n    }\n  }\n}\n\nexport const backgroundTimerManager = new BackgroundTimerManager();","/**\n * Haptic and audio feedback utilities for workout timers\n */\nexport class FeedbackManager {\n  private audioContext: AudioContext | null = null;\n  private enableHaptic = true;\n  private enableAudio = true;\n\n  constructor() {\n    // Initialize audio context on first user interaction\n    document.addEventListener('touchstart', this.initAudioContext.bind(this), { once: true });\n    document.addEventListener('click', this.initAudioContext.bind(this), { once: true });\n  }\n\n  private initAudioContext() {\n    try {\n      this.audioContext = new (window.AudioContext || (window as any).webkitAudioContext)();\n      console.log('Audio context initialized');\n    } catch (error) {\n      console.warn('Audio context not supported:', error);\n    }\n  }\n\n  /**\n   * Enable or disable haptic feedback\n   */\n  setHapticEnabled(enabled: boolean) {\n    this.enableHaptic = enabled;\n  }\n\n  /**\n   * Enable or disable audio feedback  \n   */\n  setAudioEnabled(enabled: boolean) {\n    this.enableAudio = enabled;\n  }\n\n  /**\n   * Check if haptic feedback is supported\n   */\n  isHapticSupported(): boolean {\n    return 'vibrate' in navigator;\n  }\n\n  /**\n   * Check if audio feedback is supported\n   */\n  isAudioSupported(): boolean {\n    return this.audioContext !== null;\n  }\n\n  /**\n   * Provide haptic feedback\n   */\n  vibrate(pattern: number | number[]) {\n    if (!this.enableHaptic || !this.isHapticSupported()) {\n      return;\n    }\n\n    try {\n      navigator.vibrate(pattern);\n    } catch (error) {\n      console.warn('Vibration failed:', error);\n    }\n  }\n\n  /**\n   * Play a beep sound\n   */\n  beep(frequency: number = 800, duration: number = 200, volume: number = 0.1) {\n    if (!this.enableAudio || !this.audioContext) {\n      return;\n    }\n\n    try {\n      const oscillator = this.audioContext.createOscillator();\n      const gainNode = this.audioContext.createGain();\n\n      oscillator.connect(gainNode);\n      gainNode.connect(this.audioContext.destination);\n\n      oscillator.frequency.value = frequency;\n      oscillator.type = 'sine';\n      \n      gainNode.gain.setValueAtTime(volume, this.audioContext.currentTime);\n      gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + duration / 1000);\n\n      oscillator.start();\n      oscillator.stop(this.audioContext.currentTime + duration / 1000);\n    } catch (error) {\n      console.warn('Audio playback failed:', error);\n    }\n  }\n\n  /**\n   * Timer start feedback\n   */\n  timerStart() {\n    this.vibrate(100);\n    this.beep(600, 150);\n  }\n\n  /**\n   * Timer pause feedback\n   */\n  timerPause() {\n    this.vibrate([50, 50, 50]);\n    this.beep(400, 100);\n  }\n\n  /**\n   * Round complete feedback\n   */\n  roundComplete() {\n    this.vibrate([100, 50, 100]);\n    this.beep(800, 200);\n  }\n\n  /**\n   * Exercise complete feedback\n   */\n  exerciseComplete() {\n    this.vibrate([150, 100, 150, 100, 150]);\n    this.playSuccess();\n  }\n\n  /**\n   * Session complete feedback\n   */\n  sessionComplete() {\n    this.vibrate([200, 100, 200, 100, 200, 100, 300]);\n    this.playSuccessChord();\n  }\n\n  /**\n   * Set complete feedback\n   */\n  setComplete() {\n    this.vibrate([100, 50, 100]);\n    this.beep(700, 150);\n  }\n\n  /**\n   * Rest start feedback (between sets)\n   */\n  restStart() {\n    this.vibrate(80);\n    this.beep(500, 150);\n  }\n\n  /**\n   * Rest complete feedback\n   */\n  restComplete() {\n    this.vibrate([50, 30, 50]);\n    this.beep(800, 100);\n  }\n\n  /**\n   * Work period start feedback (for circuits/N90)\n   */\n  workPeriodStart() {\n    this.vibrate([50, 30, 50]);\n    this.beep(1000, 100);\n  }\n\n  /**\n   * Rest period start feedback\n   */\n  restPeriodStart() {\n    this.vibrate(80);\n    this.beep(500, 150);\n  }\n\n  /**\n   * Countdown warning (last 3 seconds)\n   */\n  countdownWarning() {\n    this.vibrate(50);\n    this.beep(700, 100);\n  }\n\n  /**\n   * Play success sound (ascending notes)\n   */\n  private playSuccess() {\n    if (!this.audioContext) return;\n    \n    const notes = [523, 659, 784]; // C, E, G\n    notes.forEach((freq, index) => {\n      setTimeout(() => {\n        this.beep(freq, 200, 0.08);\n      }, index * 100);\n    });\n  }\n\n  /**\n   * Play success chord for session completion\n   */\n  private playSuccessChord() {\n    if (!this.audioContext) return;\n    \n    // Play a major chord\n    const chord = [523, 659, 784]; // C, E, G\n    chord.forEach(freq => {\n      this.beep(freq, 500, 0.05);\n    });\n  }\n\n  /**\n   * Test all feedback types\n   */\n  testFeedback() {\n    console.log('Testing feedback...');\n    \n    setTimeout(() => this.timerStart(), 0);\n    setTimeout(() => this.workPeriodStart(), 1000);\n    setTimeout(() => this.countdownWarning(), 2000);\n    setTimeout(() => this.restPeriodStart(), 3000);\n    setTimeout(() => this.roundComplete(), 4000);\n    setTimeout(() => this.exerciseComplete(), 5000);\n  }\n}\n\nexport const feedbackManager = new FeedbackManager();","import { BaseTimer, TimerEvent } from '../timers/timer-engine';\nimport { TimerFactory } from '../timers/timer-factory';\nimport { Day, Block, Exercise } from '../types';\nimport { wakeLockManager } from '../utils/wake-lock';\nimport { backgroundTimerManager } from '../utils/background-timer';\nimport { feedbackManager } from '../utils/feedback';\n\nexport class ViewSession extends HTMLElement {\n  private currentDay: Day | null = null;\n  private currentBlockIndex = 0;\n  private currentExerciseIndex = 0;\n  private currentSetIndex = 0; // Track current set within exercise\n  private currentTimer: BaseTimer | null = null;\n  private sessionStartTime: number = 0;\n  private foregroundCallback: (() => void) | null = null;\n  private lastPhase: string | null = null;\n  private isRestingBetweenSets = false; // Track if we're in rest period between sets\n\n  constructor() {\n    super();\n    this.attachShadow({ mode: 'open' });\n  }\n\n  connectedCallback() {\n    this.render();\n    this.setupEventListeners();\n    this.setupBackgroundHandling();\n  }\n\n  disconnectedCallback() {\n    this.cleanup();\n  }\n\n  setDay(day: Day) {\n    this.currentDay = day;\n    this.currentBlockIndex = 0;\n    this.currentExerciseIndex = 0;\n    this.currentSetIndex = 0;\n    this.isRestingBetweenSets = false;\n    console.log('Day loaded:', day);\n    console.log('Blocks:', day.blocks);\n    this.render();\n  }\n\n  private render() {\n    if (!this.shadowRoot) return;\n\n    this.shadowRoot.innerHTML = `\n      <style>\n        :host {\n          display: block;\n          height: 100%;\n          padding: 0;\n        }\n\n        .session-container {\n          display: flex;\n          flex-direction: column;\n          height: 100%;\n          background: var(--bg-primary);\n        }\n\n        .session-header {\n          background: var(--bg-secondary);\n          padding: 16px;\n          border-bottom: 1px solid var(--border);\n          flex-shrink: 0;\n        }\n\n        .session-title {\n          font-size: 18px;\n          font-weight: 600;\n          margin: 0 0 8px 0;\n        }\n\n        .session-progress {\n          font-size: 14px;\n          color: var(--text-secondary);\n        }\n\n        .session-main {\n          flex: 1;\n          display: flex;\n          flex-direction: column;\n          overflow: hidden;\n        }\n\n        .current-exercise {\n          background: var(--bg-secondary);\n          padding: 20px;\n          text-align: center;\n          flex-shrink: 0;\n        }\n\n        .exercise-group {\n          margin-bottom: 16px;\n        }\n\n        .exercise-group:last-child {\n          margin-bottom: 0;\n        }\n\n        .exercise-name {\n          font-size: 24px;\n          font-weight: 700;\n          margin: 0 0 8px 0;\n          color: var(--accent);\n        }\n\n        .exercise-details {\n          font-size: 16px;\n          color: var(--text-secondary);\n          margin: 0 0 16px 0;\n        }\n\n        .timer-section {\n          background: var(--bg-primary);\n          padding: 32px 20px;\n          text-align: center;\n          flex-shrink: 0;\n        }\n\n        .timer-display {\n          font-size: 48px;\n          font-weight: 700;\n          font-variant-numeric: tabular-nums;\n          margin: 0 0 8px 0;\n          color: var(--text-primary);\n        }\n\n        .timer-phase {\n          font-size: 18px;\n          font-weight: 500;\n          margin: 0 0 8px 0;\n          color: var(--accent);\n        }\n\n        .timer-progress {\n          font-size: 14px;\n          color: var(--text-secondary);\n          margin: 0 0 24px 0;\n        }\n\n        .progress-bar {\n          width: 100%;\n          height: 4px;\n          background: var(--border);\n          border-radius: 2px;\n          margin: 16px 0;\n          overflow: hidden;\n        }\n\n        .progress-fill {\n          height: 100%;\n          background: var(--accent);\n          border-radius: 2px;\n          transition: width 0.1s ease;\n          width: 0%;\n        }\n\n        .session-controls {\n          padding: 20px;\n          display: flex;\n          gap: 12px;\n          justify-content: center;\n          flex-shrink: 0;\n        }\n\n        .control-btn {\n          padding: 12px 24px;\n          font-size: 16px;\n          font-weight: 600;\n          border: none;\n          border-radius: 8px;\n          cursor: pointer;\n          transition: all 0.2s;\n          min-width: 100px;\n        }\n\n        .control-btn.primary {\n          background: var(--accent);\n          color: white;\n        }\n\n        .control-btn.secondary {\n          background: var(--bg-secondary);\n          color: var(--text-primary);\n          border: 1px solid var(--border);\n        }\n\n        .control-btn.warning {\n          background: var(--warning);\n          color: white;\n        }\n\n        .control-btn:disabled {\n          opacity: 0.5;\n          cursor: not-allowed;\n        }\n\n        .next-up {\n          padding: 16px 20px;\n          background: var(--bg-secondary);\n          border-top: 1px solid var(--border);\n          flex-shrink: 0;\n        }\n\n        .next-up-label {\n          font-size: 12px;\n          color: var(--text-secondary);\n          text-transform: uppercase;\n          letter-spacing: 0.5px;\n          margin: 0 0 4px 0;\n        }\n\n        .next-up-exercise {\n          font-size: 16px;\n          font-weight: 500;\n          margin: 0;\n        }\n\n        .session-empty {\n          flex: 1;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          text-align: center;\n          color: var(--text-secondary);\n          padding: 40px 20px;\n        }\n\n        .session-complete {\n          flex: 1;\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          justify-content: center;\n          text-align: center;\n          padding: 40px 20px;\n        }\n\n        .complete-icon {\n          font-size: 64px;\n          margin: 0 0 16px 0;\n        }\n\n        .complete-title {\n          font-size: 24px;\n          font-weight: 700;\n          margin: 0 0 8px 0;\n        }\n\n        .complete-stats {\n          font-size: 16px;\n          color: var(--text-secondary);\n          margin: 0;\n        }\n\n        .session-save-overlay {\n          position: fixed;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n          background: rgba(0, 0, 0, 0.7);\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          z-index: 1000;\n        }\n\n        .session-save-dialog {\n          background: var(--bg-primary);\n          border: 1px solid var(--border);\n          border-radius: 16px;\n          padding: 32px;\n          margin: 16px;\n          text-align: center;\n          max-width: 400px;\n          width: 100%;\n          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);\n        }\n\n        .session-save-dialog h3 {\n          font-size: 24px;\n          font-weight: 700;\n          margin: 0 0 16px 0;\n          color: var(--text-primary);\n        }\n\n        .session-save-dialog p {\n          font-size: 16px;\n          color: var(--text-secondary);\n          margin: 0 0 8px 0;\n        }\n\n        .dialog-actions {\n          display: flex;\n          gap: 12px;\n          margin-top: 24px;\n        }\n\n        .discard-btn, .save-btn {\n          flex: 1;\n          padding: 12px 24px;\n          border: none;\n          border-radius: 8px;\n          font-size: 16px;\n          font-weight: 600;\n          cursor: pointer;\n          transition: all 0.2s;\n        }\n\n        .discard-btn {\n          background: var(--bg-secondary);\n          color: var(--text-secondary);\n          border: 1px solid var(--border);\n        }\n\n        .discard-btn:hover {\n          background: var(--border);\n          color: var(--text-primary);\n        }\n\n        .save-btn {\n          background: var(--accent);\n          color: white;\n        }\n\n        .save-btn:hover {\n          opacity: 0.9;\n        }\n\n        .cancel-session-btn {\n          padding: 8px 16px;\n          background: var(--bg-primary);\n          color: var(--text-secondary);\n          border: 1px solid var(--border);\n          border-radius: 6px;\n          font-size: 14px;\n          cursor: pointer;\n          transition: all 0.2s;\n        }\n\n        .cancel-session-btn:hover {\n          background: var(--border);\n          color: var(--text-primary);\n        }\n\n        @media (prefers-color-scheme: dark) {\n          :host {\n            --bg-primary: #000000;\n            --bg-secondary: #1a1a1a;\n            --text-primary: #ffffff;\n            --text-secondary: #999999;\n            --border: #333333;\n            --accent: #007AFF;\n            --warning: #FF9500;\n          }\n        }\n\n        @media (prefers-color-scheme: light) {\n          :host {\n            --bg-primary: #ffffff;\n            --bg-secondary: #f5f5f5;\n            --text-primary: #000000;\n            --text-secondary: #666666;\n            --border: #e0e0e0;\n            --accent: #007AFF;\n            --warning: #FF9500;\n          }\n        }\n      </style>\n\n      <div class=\"session-container\">\n        ${this.renderContent()}\n      </div>\n    `;\n  }\n\n  private renderContent(): string {\n    if (!this.currentDay) {\n      return `\n        <div class=\"session-empty\">\n          <div>\n            <h2>No Workout Selected</h2>\n            <p>Select a day to start your session</p>\n          </div>\n        </div>\n      `;\n    }\n\n    const currentBlock = this.getCurrentBlock();\n    if (!currentBlock) {\n      return this.renderSessionComplete();\n    }\n\n    // Check if this is an interval block with multiple exercises\n    const isCompoundInterval = currentBlock.timerType === 'interval' && \n                               currentBlock.timerConfig?.exercisesPerInterval && \n                               currentBlock.timerConfig.exercisesPerInterval > 1;\n\n    if (!isCompoundInterval) {\n      // Single exercise flow\n      const currentExercise = this.getCurrentExercise();\n      if (!currentExercise) {\n        return this.renderSessionComplete();\n      }\n    } else {\n      // For compound intervals, check if we have exercises left\n      if (this.currentExerciseIndex >= currentBlock.exercises.length) {\n        return this.renderSessionComplete();\n      }\n    }\n\n    return `\n      ${this.renderHeader()}\n      <div class=\"session-main\">\n        ${this.renderCurrentExercises()}\n        ${this.renderTimer()}\n        ${this.renderControls()}\n        ${this.renderNextUp()}\n      </div>\n    `;\n  }\n\n  private renderHeader(): string {\n    if (!this.currentDay) return '';\n\n    const totalBlocks = this.currentDay.blocks.length;\n    const totalExercises = this.currentDay.blocks.reduce((sum, block) => sum + block.exercises.length, 0);\n    const completedExercises = this.currentBlockIndex * (this.currentDay.blocks[0]?.exercises.length || 0) + this.currentExerciseIndex;\n\n    return `\n      <div class=\"session-header\">\n        <div class=\"session-info\">\n          <div class=\"session-title\">${this.currentDay.title}</div>\n          <div class=\"session-progress\">\n            Block ${this.currentBlockIndex + 1} of ${totalBlocks}  \n            Exercise ${completedExercises + 1} of ${totalExercises}\n          </div>\n        </div>\n        <button class=\"cancel-session-btn\" id=\"cancel-session\">Cancel</button>\n      </div>\n    `;\n  }\n\n  private renderCurrentExercises(): string {\n    const block = this.getCurrentBlock();\n    if (!block) return '';\n\n    // Debug logging\n    console.log('Block timer type:', block.timerType);\n    console.log('Block timer config:', block.timerConfig);\n    console.log('Exercises per interval:', block.timerConfig?.exercisesPerInterval);\n\n    // For interval timers with multiple exercises per interval, show all exercises for current round\n    if (block.timerType === 'interval' && block.timerConfig?.exercisesPerInterval && block.timerConfig.exercisesPerInterval > 1) {\n      const exercisesPerInterval = block.timerConfig.exercisesPerInterval;\n      // Get the exercises for the current interval round\n      const startIdx = Math.floor(this.currentExerciseIndex / exercisesPerInterval) * exercisesPerInterval;\n      const exercisesToShow = block.exercises.slice(startIdx, startIdx + exercisesPerInterval);\n      \n      console.log('Showing compound exercises:', exercisesToShow.map(e => e.name));\n      \n      return `\n        <div class=\"current-exercise\">\n          ${exercisesToShow.map(ex => `\n            <div class=\"exercise-group\">\n              <div class=\"exercise-name\">${ex.name}</div>\n              <div class=\"exercise-details\">${this.formatExerciseDetails(ex, block)}</div>\n            </div>\n          `).join('')}\n        </div>\n      `;\n    }\n\n    // Single exercise flow\n    const exercise = this.getCurrentExercise();\n    if (!exercise) return '';\n\n    return `\n      <div class=\"current-exercise\">\n        <div class=\"exercise-name\">${exercise.name}</div>\n        <div class=\"exercise-details\">${this.formatExerciseDetails(exercise, block)}</div>\n      </div>\n    `;\n  }\n\n  private renderTimer(): string {\n    const exercise = this.getCurrentExercise();\n    const block = this.getCurrentBlock();\n    const hasBlockTimer = block?.timerType && block.timerType !== 'none';\n    \n    // For interval blocks with multiple exercises, show interval info\n    if (block?.timerType === 'interval' && block.timerConfig?.exercisesPerInterval && block.timerConfig.exercisesPerInterval > 1) {\n      const intervalMinutes = (block.timerConfig.intervalSec || 120) / 60;\n      const exerciseCount = block.timerConfig.exercisesPerInterval;\n      \n      if (this.currentTimer) {\n        const remaining = this.currentTimer.getRemainingInCurrentPeriod();\n        const currentRound = this.currentTimer.getCurrentRound();\n        const totalRounds = this.currentTimer.getTotalRounds();\n        const timerDisplay = BaseTimer.formatTime(remaining);\n        const progress = this.getTimerProgress();\n        \n        return `\n          <div class=\"timer-section\">\n            <div class=\"timer-display\">${timerDisplay}</div>\n            <div class=\"timer-phase\">Interval ${currentRound} of ${totalRounds}</div>\n            <div class=\"timer-progress\">Complete all ${exerciseCount} exercises  Every ${intervalMinutes} min</div>\n            <div class=\"progress-bar\">\n              <div class=\"progress-fill\" style=\"width: ${progress * 100}%\"></div>\n            </div>\n          </div>\n        `;\n      } else {\n        return `\n          <div class=\"timer-section\">\n            <div class=\"timer-display\">--:--</div>\n            <div class=\"timer-phase\">Ready to start</div>\n            <div class=\"timer-progress\">Every ${intervalMinutes} min  ${exerciseCount} exercises per interval</div>\n          </div>\n        `;\n      }\n    }\n\n    // For exercises with set-based rest periods\n    if (!hasBlockTimer && exercise) {\n      const totalSets = exercise.sets || 1;\n      const setNumber = this.currentSetIndex + 1;\n\n      if (this.isRestingBetweenSets && this.currentTimer) {\n        const remaining = this.currentTimer.getRemainingInCurrentPeriod();\n        const timerDisplay = BaseTimer.formatTime(remaining);\n        const elapsed = this.currentTimer.getElapsedTime();\n        const duration = this.currentTimer.getDuration();\n        const progress = Math.min(elapsed / duration, 1);\n\n        return `\n          <div class=\"timer-section\">\n            <div class=\"timer-display\">${timerDisplay}</div>\n            <div class=\"timer-phase\">Rest after Set ${setNumber - 1}</div>\n            <div class=\"timer-progress\">Set ${setNumber}/${totalSets} next</div>\n            <div class=\"progress-bar\">\n              <div class=\"progress-fill\" style=\"width: ${progress * 100}%\"></div>\n            </div>\n          </div>\n        `;\n      }\n\n      // Show set info when not resting\n      return `\n        <div class=\"timer-section\">\n          <div class=\"timer-display\">Set ${setNumber}/${totalSets}</div>\n          <div class=\"timer-phase\">${exercise.reps} reps</div>\n          ${exercise.restSec ? `<div class=\"timer-progress\">${exercise.restSec}s rest after set</div>` : ''}\n        </div>\n      `;\n    }\n\n    // Handle block-level timers (EMOM, Circuit, etc.)\n    if (!this.currentTimer) {\n      return `\n        <div class=\"timer-section\">\n          <div class=\"timer-display\">--:--</div>\n          <div class=\"timer-phase\">Ready to start</div>\n        </div>\n      `;\n    }\n\n    const remaining = this.currentTimer.getRemainingInCurrentPeriod();\n    const currentRound = this.currentTimer.getCurrentRound();\n    const totalRounds = this.currentTimer.getTotalRounds();\n\n    const timerDisplay = BaseTimer.formatTime(remaining);\n    const progress = this.getTimerProgress();\n    const phase = this.getTimerPhase();\n\n    return `\n      <div class=\"timer-section\">\n        <div class=\"timer-display\">${timerDisplay}</div>\n        <div class=\"timer-phase\">${phase}</div>\n        <div class=\"timer-progress\">Round ${currentRound} of ${totalRounds}</div>\n        <div class=\"progress-bar\">\n          <div class=\"progress-fill\" style=\"width: ${progress * 100}%\"></div>\n        </div>\n      </div>\n    `;\n  }\n\n  private renderControls(): string {\n    const block = this.getCurrentBlock();\n    const hasBlockTimer = block?.timerType && block.timerType !== 'none';\n    \n    // Handle block-level timers (EMOM, Circuit, etc.)\n    if (hasBlockTimer) {\n      const timerState = this.currentTimer?.getState() || 'idle';\n      const isCompleted = timerState === 'completed';\n      const isCompoundInterval = block.timerType === 'interval' && \n                                 block.timerConfig?.exercisesPerInterval && \n                                 block.timerConfig.exercisesPerInterval > 1;\n\n      let primaryButton = '';\n      if (!this.currentTimer || timerState === 'idle') {\n        primaryButton = `<button class=\"control-btn primary\" id=\"start-btn\">Start Timer</button>`;\n      } else if (timerState === 'running') {\n        primaryButton = `<button class=\"control-btn warning\" id=\"pause-btn\">Pause</button>`;\n      } else if (timerState === 'paused') {\n        primaryButton = `<button class=\"control-btn primary\" id=\"resume-btn\">Resume</button>`;\n      } else if (isCompleted) {\n        const buttonText = isCompoundInterval ? 'Next Round' : 'Next Exercise';\n        primaryButton = `<button class=\"control-btn primary\" id=\"next-btn\">${buttonText}</button>`;\n      }\n\n      return `\n        <div class=\"session-controls\">\n          ${primaryButton}\n          <button class=\"control-btn secondary\" id=\"reset-btn\" ${(!this.currentTimer || timerState === 'idle') ? 'disabled' : ''}>Reset</button>\n          <button class=\"control-btn secondary\" id=\"skip-btn\">Skip</button>\n        </div>\n      `;\n    }\n\n    const exercise = this.getCurrentExercise();\n\n    // Handle set-based exercises (no block timer, but sets with rest)\n    if (!exercise) {\n      return `<div class=\"session-controls\"><button class=\"control-btn secondary\" id=\"skip-btn\">Skip</button></div>`;\n    }\n\n    const totalSets = exercise.sets || 1;\n    const isRestingBetweenSets = this.isRestingBetweenSets;\n    const timerState = this.currentTimer?.getState() || 'idle';\n\n    // If we're resting between sets (timer running)\n    if (isRestingBetweenSets && this.currentTimer) {\n      if (timerState === 'running') {\n        return `\n          <div class=\"session-controls\">\n            <button class=\"control-btn warning\" id=\"pause-btn\">Pause Rest</button>\n            <button class=\"control-btn secondary\" id=\"skip-rest-btn\">Skip Rest</button>\n          </div>\n        `;\n      } else if (timerState === 'paused') {\n        return `\n          <div class=\"session-controls\">\n            <button class=\"control-btn primary\" id=\"resume-btn\">Resume Rest</button>\n            <button class=\"control-btn secondary\" id=\"skip-rest-btn\">Skip Rest</button>\n          </div>\n        `;\n      } else if (timerState === 'completed') {\n        return `\n          <div class=\"session-controls\">\n            <button class=\"control-btn primary\" id=\"next-set-btn\">Start Next Set</button>\n          </div>\n        `;\n      }\n    }\n\n    // Default state: ready for next set\n    const setNumber = this.currentSetIndex + 1;\n\n    return `\n      <div class=\"session-controls\">\n        <button class=\"control-btn primary\" id=\"complete-set-btn\">\n          Complete Set ${setNumber}/${totalSets}\n        </button>\n        <button class=\"control-btn secondary\" id=\"skip-btn\">Skip Exercise</button>\n      </div>\n    `;\n  }\n\n  private renderNextUp(): string {\n    const nextExercise = this.getNextExercise();\n    if (!nextExercise) {\n      return `\n        <div class=\"next-up\">\n          <div class=\"next-up-label\">Next Up</div>\n          <div class=\"next-up-exercise\">Session Complete!</div>\n        </div>\n      `;\n    }\n\n    return `\n      <div class=\"next-up\">\n        <div class=\"next-up-label\">Next Up</div>\n        <div class=\"next-up-exercise\">${nextExercise.name}</div>\n      </div>\n    `;\n  }\n\n  private renderSessionComplete(): string {\n    const duration = this.sessionStartTime ? performance.now() - this.sessionStartTime : 0;\n    const formattedDuration = BaseTimer.formatTime(duration);\n\n    return `\n      <div class=\"session-complete\">\n        <div class=\"complete-icon\"></div>\n        <div class=\"complete-title\">Workout Complete!</div>\n        <div class=\"complete-stats\">Duration: ${formattedDuration}</div>\n        <div class=\"session-controls\">\n          <button class=\"control-btn primary\" id=\"finish-btn\">Finish Session</button>\n        </div>\n      </div>\n    `;\n  }\n\n  private getCurrentBlock(): Block | null {\n    if (!this.currentDay || this.currentBlockIndex >= this.currentDay.blocks.length) {\n      return null;\n    }\n    return this.currentDay.blocks[this.currentBlockIndex];\n  }\n\n  private getCurrentExercise(): Exercise | null {\n    const block = this.getCurrentBlock();\n    if (!block || this.currentExerciseIndex >= block.exercises.length) {\n      return null;\n    }\n    return block.exercises[this.currentExerciseIndex];\n  }\n\n  private getNextExercise(): Exercise | null {\n    const block = this.getCurrentBlock();\n    if (!block) return null;\n\n    // For interval timers with multiple exercises, advance by the number of exercises per interval\n    let advanceBy = 1;\n    if (block.timerType === 'interval' && block.timerConfig?.exercisesPerInterval) {\n      advanceBy = block.timerConfig.exercisesPerInterval;\n    }\n\n    // Check if there's a next exercise in current block\n    if (this.currentExerciseIndex + advanceBy < block.exercises.length) {\n      return block.exercises[this.currentExerciseIndex + advanceBy];\n    }\n\n    // Check if there's a next block\n    if (!this.currentDay || this.currentBlockIndex + 1 >= this.currentDay.blocks.length) {\n      return null;\n    }\n\n    const nextBlock = this.currentDay.blocks[this.currentBlockIndex + 1];\n    return nextBlock.exercises[0] || null;\n  }\n\n  private formatExerciseDetails(exercise: Exercise, block: Block): string {\n    const parts = [];\n    \n    // For interval blocks, don't show individual rest times\n    const isIntervalBlock = block.timerType === 'interval';\n    \n    if (exercise.sets) parts.push(`${exercise.sets} sets`);\n    if (exercise.reps) parts.push(`${exercise.reps} reps`);\n    if (!isIntervalBlock && exercise.restSec) parts.push(`${exercise.restSec}s rest`);\n\n    return parts.join('  ');\n  }\n\n  private getTimerProgress(): number {\n    if (!this.currentTimer) return 0;\n\n    const elapsed = this.currentTimer.getElapsedTime();\n    const total = this.currentTimer.getDuration();\n    return Math.min(elapsed / total, 1);\n  }\n\n  private getTimerPhase(): string {\n    if (!this.currentTimer) return 'Ready';\n\n    const block = this.getCurrentBlock();\n    const hasTimer = block?.timerType && block.timerType !== 'none';\n    if (!hasTimer) return 'Timer Running';\n\n    // Check if timer is an interval type timer with multiple rounds\n    if (this.currentTimer && this.currentTimer.getTotalRounds() > 1) {\n      const phase = (this.currentTimer as any).getCurrentPhase?.();\n      if (phase === 'work') return 'Work Period';\n      if (phase === 'rest') return 'Rest Period';\n    }\n\n    return 'Timer Running';\n  }\n\n  private createTimerForCurrentBlock(): BaseTimer | null {\n    const block = this.getCurrentBlock();\n    if (!block?.timerType || block.timerType === 'none') return null;\n\n    // For interval blocks with multiple exercises, adjust rounds based on current position\n    if (block.timerType === 'interval' && block.timerConfig?.exercisesPerInterval && block.timerConfig.exercisesPerInterval > 1) {\n      const exercisesPerInterval = block.timerConfig.exercisesPerInterval;\n      const currentRoundIndex = Math.floor(this.currentExerciseIndex / exercisesPerInterval);\n      const totalRounds = Math.ceil(block.exercises.length / exercisesPerInterval);\n      const remainingRounds = totalRounds - currentRoundIndex;\n      \n      // Create timer for remaining rounds\n      return TimerFactory.createTimer(block.timerType, {\n        ...block.timerConfig,\n        rounds: remainingRounds\n      });\n    }\n\n    return TimerFactory.createTimer(block.timerType, block.timerConfig);\n  }\n\n  private setupEventListeners() {\n    if (!this.shadowRoot) return;\n\n    this.shadowRoot.addEventListener('click', (e) => {\n      const target = e.target as HTMLElement;\n\n      if (target.id === 'start-btn') {\n        this.startTimer();\n      } else if (target.id === 'pause-btn') {\n        this.pauseTimer();\n      } else if (target.id === 'resume-btn') {\n        this.resumeTimer();\n      } else if (target.id === 'reset-btn') {\n        this.resetTimer();\n      } else if (target.id === 'skip-btn') {\n        this.skipExercise();\n      } else if (target.id === 'complete-exercise-btn') {\n        this.completeExercise();\n      } else if (target.id === 'complete-set-btn') {\n        this.completeSet();\n      } else if (target.id === 'skip-rest-btn') {\n        this.skipRest();\n      } else if (target.id === 'next-set-btn') {\n        this.startNextSet();\n      } else if (target.id === 'next-btn') {\n        this.nextExercise();\n      } else if (target.id === 'finish-btn') {\n        this.finishSession();\n      } else if (target.id === 'cancel-session') {\n        this.cancelSession();\n      }\n    });\n  }\n\n  private async startTimer() {\n    if (!this.sessionStartTime) {\n      this.sessionStartTime = performance.now();\n      // Request notification permission when starting first timer\n      await backgroundTimerManager.requestNotificationPermission();\n    }\n\n    // Acquire wake lock to keep screen active\n    await wakeLockManager.acquire();\n\n    this.currentTimer = this.createTimerForCurrentBlock();\n    if (!this.currentTimer) return;\n\n    this.currentTimer.addCallback((event: TimerEvent) => {\n      this.handleTimerEvent(event);\n    });\n\n    this.currentTimer.start();\n    feedbackManager.timerStart();\n    this.render();\n  }\n\n  private pauseTimer() {\n    this.currentTimer?.pause();\n    feedbackManager.timerPause();\n    this.render();\n  }\n\n  private resumeTimer() {\n    this.currentTimer?.start();\n    feedbackManager.timerStart();\n    this.render();\n  }\n\n  private resetTimer() {\n    this.currentTimer?.reset();\n    this.render();\n  }\n\n  private skipExercise() {\n    const block = this.getCurrentBlock();\n    if (block?.timerType === 'interval' && block.timerConfig?.exercisesPerInterval && block.timerConfig.exercisesPerInterval > 1) {\n      // Skip entire interval group\n      this.skipIntervalGroup();\n    } else {\n      this.nextExercise();\n    }\n  }\n\n  private skipIntervalGroup() {\n    const block = this.getCurrentBlock();\n    if (!block) return;\n\n    this.currentTimer?.stop();\n    this.currentTimer = null;\n\n    const exercisesPerInterval = block.timerConfig?.exercisesPerInterval || 1;\n    \n    // Move to next group of exercises\n    if (this.currentExerciseIndex + exercisesPerInterval < block.exercises.length) {\n      this.currentExerciseIndex += exercisesPerInterval;\n    } else {\n      // Move to next block\n      this.currentBlockIndex++;\n      this.currentExerciseIndex = 0;\n    }\n\n    this.render();\n  }\n\n  private completeExercise() {\n    // For now, same behavior as skip - just advance to next exercise\n    // TODO: Future enhancement could handle rest periods between exercises\n    this.nextExercise();\n  }\n\n  private async completeSet() {\n    const exercise = this.getCurrentExercise();\n    if (!exercise) return;\n\n    const totalSets = exercise.sets || 1;\n    const isLastSet = this.currentSetIndex >= totalSets - 1;\n\n    feedbackManager.setComplete();\n\n    if (isLastSet) {\n      // Exercise is complete, move to next exercise\n      this.nextExercise();\n    } else {\n      // Start rest timer if exercise has rest time\n      if (exercise.restSec && exercise.restSec > 0) {\n        this.currentSetIndex++;\n        this.isRestingBetweenSets = true;\n        \n        // Create rest timer\n        this.currentTimer = TimerFactory.createRestTimer(exercise.restSec, 1);\n        this.currentTimer.addCallback((event) => {\n          if (event.type === 'complete') {\n            this.handleRestComplete();\n          } else if (event.type === 'tick') {\n            // Update display on each tick\n            this.updateTimerDisplay();\n          }\n        });\n        \n        // Start rest timer\n        this.currentTimer.start();\n        feedbackManager.restStart();\n      } else {\n        // No rest time, just move to next set\n        this.currentSetIndex++;\n      }\n      \n      this.render();\n    }\n  }\n\n  private skipRest() {\n    if (this.currentTimer) {\n      this.currentTimer.stop();\n      this.currentTimer = null;\n    }\n    this.handleRestComplete();\n  }\n\n  private startNextSet() {\n    this.handleRestComplete();\n  }\n\n  private handleRestComplete() {\n    this.isRestingBetweenSets = false;\n    this.currentTimer?.stop();\n    this.currentTimer = null;\n    feedbackManager.restComplete();\n    this.render();\n  }\n\n  private nextExercise() {\n    const block = this.getCurrentBlock();\n    if (!block) return;\n\n    feedbackManager.exerciseComplete();\n\n    this.currentTimer?.stop();\n    this.currentTimer = null;\n\n    // Reset set tracking for new exercise\n    this.currentSetIndex = 0;\n    this.isRestingBetweenSets = false;\n\n    // For interval timers with multiple exercises, advance by the number of exercises per interval\n    let advanceBy = 1;\n    if (block.timerType === 'interval' && block.timerConfig?.exercisesPerInterval) {\n      advanceBy = block.timerConfig.exercisesPerInterval;\n    }\n\n    // Move to next exercise(s) in current block\n    if (this.currentExerciseIndex + advanceBy < block.exercises.length) {\n      this.currentExerciseIndex += advanceBy;\n    } else {\n      // Move to next block\n      this.currentBlockIndex++;\n      this.currentExerciseIndex = 0;\n    }\n\n    this.render();\n  }\n\n  private async finishSession() {\n    feedbackManager.sessionComplete();\n    await this.cleanup();\n    \n    // Show save/discard dialog\n    this.showSessionSaveDialog();\n  }\n\n  private showSessionSaveDialog() {\n    const duration = this.sessionStartTime ? Math.round((performance.now() - this.sessionStartTime) / 1000) : 0;\n    const minutes = Math.floor(duration / 60);\n    const seconds = duration % 60;\n    const durationText = `${minutes}:${seconds.toString().padStart(2, '0')}`;\n\n    if (!this.shadowRoot) return;\n    \n    // Create overlay dialog\n    const dialogHtml = `\n      <div class=\"session-save-overlay\">\n        <div class=\"session-save-dialog\">\n          <h3>Session Complete!</h3>\n          <p>Duration: ${durationText}</p>\n          <p>Do you want to save this workout session?</p>\n          \n          <div class=\"dialog-actions\">\n            <button class=\"discard-btn\" id=\"discard-session\">\n              Discard Session\n            </button>\n            <button class=\"save-btn\" id=\"save-session\">\n              Save Session\n            </button>\n          </div>\n        </div>\n      </div>\n    `;\n\n    // Add dialog to shadow DOM\n    const dialogElement = document.createElement('div');\n    dialogElement.innerHTML = dialogHtml;\n    this.shadowRoot.appendChild(dialogElement);\n\n    // Add event listeners\n    const discardBtn = this.shadowRoot.querySelector('#discard-session');\n    const saveBtn = this.shadowRoot.querySelector('#save-session');\n\n    discardBtn?.addEventListener('click', () => {\n      this.discardSession();\n    });\n\n    saveBtn?.addEventListener('click', () => {\n      this.saveSession();\n    });\n  }\n\n  private discardSession() {\n    console.log('Session discarded (not saved)');\n    \n    this.dispatchEvent(new CustomEvent('session-complete', {\n      detail: {\n        day: this.currentDay,\n        duration: this.sessionStartTime ? performance.now() - this.sessionStartTime : 0,\n        saved: false\n      }\n    }));\n  }\n\n  private saveSession() {\n    console.log('Session saved');\n    \n    // TODO: Actually save session data to IndexedDB\n    this.dispatchEvent(new CustomEvent('session-complete', {\n      detail: {\n        day: this.currentDay,\n        duration: this.sessionStartTime ? performance.now() - this.sessionStartTime : 0,\n        saved: true\n      }\n    }));\n  }\n\n  private async cancelSession() {\n    const confirmed = confirm('Are you sure you want to cancel this session? Your progress will not be saved.');\n    \n    if (confirmed) {\n      console.log('Session cancelled by user');\n      await this.cleanup();\n      \n      this.dispatchEvent(new CustomEvent('session-complete', {\n        detail: {\n          day: this.currentDay,\n          duration: this.sessionStartTime ? performance.now() - this.sessionStartTime : 0,\n          saved: false,\n          cancelled: true\n        }\n      }));\n    }\n  }\n\n  private setupBackgroundHandling() {\n    // Set up callback for when app returns to foreground\n    this.foregroundCallback = () => {\n      // Re-acquire wake lock if we had one and it was lost\n      if (this.currentTimer?.getState() === 'running') {\n        wakeLockManager.reacquire();\n      }\n      \n      // Update display in case timer kept running in background\n      this.updateTimerDisplay();\n    };\n\n    backgroundTimerManager.addForegroundCallback(this.foregroundCallback);\n  }\n\n  private async cleanup() {\n    // Stop timer\n    if (this.currentTimer) {\n      this.currentTimer.stop();\n      this.currentTimer = null;\n    }\n\n    // Release wake lock\n    await wakeLockManager.release();\n\n    // Remove background callback\n    if (this.foregroundCallback) {\n      backgroundTimerManager.removeForegroundCallback(this.foregroundCallback);\n      this.foregroundCallback = null;\n    }\n  }\n\n  private handleTimerEvent(event: TimerEvent) {\n    if (event.type === 'tick') {\n      this.updateTimerDisplay();\n      this.checkForPhaseChange();\n      this.checkForCountdownWarning(event.remaining);\n    } else if (event.type === 'complete') {\n      feedbackManager.exerciseComplete();\n      this.render(); // Re-render to show \"Next Exercise\" button\n    } else if (event.type === 'roundComplete') {\n      feedbackManager.roundComplete();\n    }\n  }\n\n  private checkForPhaseChange() {\n    const currentPhase = this.getTimerPhase();\n    \n    if (this.lastPhase && this.lastPhase !== currentPhase) {\n      if (currentPhase === 'Work Period') {\n        feedbackManager.workPeriodStart();\n      } else if (currentPhase === 'Rest Period') {\n        feedbackManager.restPeriodStart();\n      }\n    }\n    \n    this.lastPhase = currentPhase;\n  }\n\n  private checkForCountdownWarning(remaining: number) {\n    // Warn at 3, 2, 1 seconds remaining\n    const secondsRemaining = Math.ceil(remaining / 1000);\n    \n    if (secondsRemaining <= 3 && secondsRemaining > 0) {\n      const lastWarnTime = (this as any).lastWarnTime || 0;\n      const currentTime = performance.now();\n      \n      // Only warn once per second\n      if (currentTime - lastWarnTime > 900) {\n        feedbackManager.countdownWarning();\n        (this as any).lastWarnTime = currentTime;\n      }\n    }\n  }\n\n  private updateTimerDisplay() {\n    if (!this.shadowRoot || !this.currentTimer) return;\n\n    const timerDisplay = this.shadowRoot.querySelector('.timer-display');\n    const progressFill = this.shadowRoot.querySelector('.progress-fill') as HTMLElement;\n    const timerProgress = this.shadowRoot.querySelector('.timer-progress');\n    const timerPhase = this.shadowRoot.querySelector('.timer-phase');\n\n    if (timerDisplay) {\n      const remaining = this.currentTimer.getRemainingInCurrentPeriod();\n      timerDisplay.textContent = BaseTimer.formatTime(remaining);\n    }\n\n    if (progressFill) {\n      const progress = this.getTimerProgress();\n      progressFill.style.width = `${progress * 100}%`;\n    }\n\n    if (timerProgress) {\n      const currentRound = this.currentTimer.getCurrentRound();\n      const totalRounds = this.currentTimer.getTotalRounds();\n      timerProgress.textContent = `Round ${currentRound} of ${totalRounds}`;\n    }\n\n    if (timerPhase) {\n      timerPhase.textContent = this.getTimerPhase();\n    }\n  }\n}\n\ncustomElements.define('view-session', ViewSession);","/**\n * App update manager for PWA\n * Handles service worker updates and notifies user when new version is available\n */\nexport class AppUpdater {\n  private registration: ServiceWorkerRegistration | null = null;\n  private showUpdateCallback: (() => void) | null = null;\n  private updateNotificationShown: boolean = false;\n\n  constructor() {\n    // Wait for DOM to be ready before setting up service worker\n    if (document.readyState === 'loading') {\n      document.addEventListener('DOMContentLoaded', () => this.setupUpdateDetection());\n    } else {\n      this.setupUpdateDetection();\n    }\n  }\n\n  private async setupUpdateDetection() {\n    if (!('serviceWorker' in navigator)) {\n      console.log('Service workers not supported');\n      return;\n    }\n\n    try {\n      // Register service worker\n      this.registration = await navigator.serviceWorker.register('/sw.js');\n      console.log('ServiceWorker registered:', this.registration);\n\n      // Check for updates immediately on startup\n      console.log('Checking for updates on startup...');\n      await this.checkForUpdates();\n      \n      // Check if there's already a waiting worker (happens on app restart)\n      console.log('Checking for waiting service worker...');\n      this.checkForWaitingWorker();\n      \n      // Double-check after a short delay to catch any race conditions\n      setTimeout(() => {\n        console.log('Double-checking for waiting service worker after delay...');\n        this.checkForWaitingWorker();\n      }, 1000);\n\n      // Also listen for when a waiting worker becomes available later\n      if (this.registration.installing) {\n        this.trackInstallingWorker(this.registration.installing);\n      }\n\n      // Check for updates every 30 seconds when app is active\n      setInterval(() => {\n        if (document.visibilityState === 'visible') {\n          console.log('Periodic update check (30s interval)');\n          this.checkForUpdates();\n        }\n      }, 30000);\n\n      // Check for updates when app comes to foreground\n      document.addEventListener('visibilitychange', () => {\n        if (document.visibilityState === 'visible') {\n          console.log('App came to foreground, checking for updates');\n          this.checkForUpdates();\n        }\n      });\n\n      // Listen for service worker updates\n      this.registration.addEventListener('updatefound', () => {\n        console.log('Update found, installing new version...');\n        const newWorker = this.registration?.installing;\n        \n        if (newWorker) {\n          this.trackInstallingWorker(newWorker);\n        }\n      });\n\n      // Listen for service worker controlling the page\n      navigator.serviceWorker.addEventListener('controllerchange', () => {\n        console.log('New service worker took control, reloading page');\n        window.location.reload();\n      });\n\n    } catch (error) {\n      console.error('ServiceWorker registration failed:', error);\n    }\n  }\n\n  private async checkForUpdates() {\n    if (!this.registration) {\n      console.log('No registration available for update check');\n      return;\n    }\n\n    try {\n      console.log('Calling registration.update()...');\n      await this.registration.update();\n      console.log('Update check completed');\n      \n      // After update check, also check if there's a waiting worker\n      if (this.registration.waiting) {\n        console.log('Found waiting worker after update check');\n        this.showUpdateAvailable();\n      }\n    } catch (error) {\n      console.error('Failed to check for updates:', error);\n    }\n  }\n\n  private checkForWaitingWorker() {\n    if (!this.registration) return;\n\n    if (this.registration.waiting) {\n      console.log('Found waiting service worker on startup');\n      this.showUpdateAvailable();\n    }\n  }\n\n  private trackInstallingWorker(worker: ServiceWorker) {\n    worker.addEventListener('statechange', () => {\n      console.log('Service worker state changed:', worker.state);\n      if (worker.state === 'installed' && navigator.serviceWorker.controller) {\n        // New version is ready\n        console.log('New version ready');\n        this.showUpdateAvailable();\n      }\n    });\n  }\n\n  private showUpdateAvailable() {\n    // Prevent showing multiple notifications\n    if (this.updateNotificationShown) {\n      console.log('Update notification already shown, skipping');\n      return;\n    }\n    \n    this.updateNotificationShown = true;\n    \n    if (this.showUpdateCallback) {\n      this.showUpdateCallback();\n    } else {\n      // Default behavior if no callback is set\n      this.showDefaultUpdateNotification();\n    }\n  }\n\n  private showDefaultUpdateNotification() {\n    if (confirm('A new version of Minimalift is available! Click OK to update now.')) {\n      this.applyUpdate();\n    }\n  }\n\n  /**\n   * Set callback function to show custom update notification\n   */\n  onUpdateAvailable(callback: () => void) {\n    this.showUpdateCallback = callback;\n  }\n\n  /**\n   * Apply the pending update\n   */\n  async applyUpdate() {\n    if (!this.registration?.waiting) {\n      console.log('No update waiting');\n      return;\n    }\n\n    // Reset the flag so future updates can be shown\n    this.updateNotificationShown = false;\n    \n    // Tell the waiting service worker to skip waiting and become active\n    this.registration.waiting.postMessage({ type: 'SKIP_WAITING' });\n  }\n\n  /**\n   * Force check for updates (public method for manual triggering)\n   */\n  async forceUpdateCheck() {\n    console.log('Manual update check triggered...');\n    await this.checkForUpdates();\n    \n    // Give some time for the update process to complete\n    setTimeout(() => {\n      this.checkForWaitingWorker();\n    }, 2000);\n  }\n}\n\nexport const appUpdater = new AppUpdater();","import { appUpdater } from '../utils/app-updater';\n\nexport class UpdateIndicator extends HTMLElement {\n  private isUpdateAvailable = false;\n\n  constructor() {\n    super();\n    this.attachShadow({ mode: 'open' });\n    this.setupUpdateListener();\n  }\n\n  connectedCallback() {\n    this.render();\n    this.setupEventListeners();\n  }\n\n  private setupUpdateListener() {\n    appUpdater.onUpdateAvailable(() => {\n      this.isUpdateAvailable = true;\n      this.show();\n    });\n  }\n\n  private render() {\n    if (!this.shadowRoot) return;\n\n    this.shadowRoot.innerHTML = `\n      <style>\n        :host {\n          display: none;\n          position: relative;\n          align-items: center;\n          justify-content: center;\n          width: 32px;\n          height: 32px;\n          cursor: pointer;\n          transition: opacity 0.3s ease;\n        }\n\n        :host(.visible) {\n          display: flex;\n        }\n\n        .indicator {\n          position: relative;\n          width: 20px;\n          height: 20px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n        }\n\n        .dot {\n          width: 8px;\n          height: 8px;\n          background: var(--accent, #007AFF);\n          border-radius: 50%;\n          animation: pulse 2s ease-in-out infinite;\n        }\n\n        .icon {\n          width: 20px;\n          height: 20px;\n          color: var(--accent, #007AFF);\n          animation: bounce 3s ease-in-out infinite;\n        }\n\n        @keyframes pulse {\n          0%, 100% {\n            transform: scale(1);\n            opacity: 1;\n          }\n          50% {\n            transform: scale(1.2);\n            opacity: 0.8;\n          }\n        }\n\n        @keyframes bounce {\n          0%, 100% {\n            transform: translateY(0);\n          }\n          50% {\n            transform: translateY(-2px);\n          }\n        }\n\n        .tooltip {\n          position: absolute;\n          bottom: -36px;\n          left: 50%;\n          transform: translateX(-50%);\n          background: rgba(0, 0, 0, 0.9);\n          color: white;\n          padding: 6px 10px;\n          border-radius: 4px;\n          font-size: 12px;\n          white-space: nowrap;\n          pointer-events: none;\n          opacity: 0;\n          transition: opacity 0.2s ease;\n          z-index: 1000;\n        }\n\n        .tooltip::before {\n          content: '';\n          position: absolute;\n          top: -4px;\n          left: 50%;\n          transform: translateX(-50%);\n          width: 0;\n          height: 0;\n          border-left: 4px solid transparent;\n          border-right: 4px solid transparent;\n          border-bottom: 4px solid rgba(0, 0, 0, 0.9);\n        }\n\n        :host(:hover) .tooltip {\n          opacity: 1;\n        }\n\n        /* Loading state */\n        :host(.updating) .indicator {\n          animation: rotate 1s linear infinite;\n        }\n\n        @keyframes rotate {\n          from {\n            transform: rotate(0deg);\n          }\n          to {\n            transform: rotate(360deg);\n          }\n        }\n      </style>\n\n      <div class=\"indicator\" aria-label=\"Update available\">\n        <!-- Using download arrow icon -->\n        <svg class=\"icon\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n          <path fill-rule=\"evenodd\" d=\"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z\" clip-rule=\"evenodd\"/>\n        </svg>\n        <div class=\"tooltip\">Update available - click to install</div>\n      </div>\n    `;\n  }\n\n  private setupEventListeners() {\n    if (!this.shadowRoot) return;\n\n    this.addEventListener('click', () => {\n      if (this.isUpdateAvailable) {\n        this.applyUpdate();\n      }\n    });\n  }\n\n  private show() {\n    this.classList.add('visible');\n  }\n\n\n  private async applyUpdate() {\n    // Show loading state\n    this.classList.add('updating');\n    \n    const indicator = this.shadowRoot?.querySelector('.indicator');\n    if (indicator) {\n      indicator.innerHTML = `\n        <svg class=\"icon\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n          <path fill-rule=\"evenodd\" d=\"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z\" clip-rule=\"evenodd\"/>\n        </svg>\n        <div class=\"tooltip\">Updating...</div>\n      `;\n    }\n\n    // Apply the update\n    await appUpdater.applyUpdate();\n  }\n}\n\ncustomElements.define('update-indicator', UpdateIndicator);","type RouteHandler = () => void;\n\ninterface Route {\n  path: string;\n  handler: RouteHandler;\n}\n\nexport class Router {\n  private routes: Route[] = [];\n  private currentPath: string = '';\n\n  constructor() {\n    window.addEventListener('hashchange', () => this.handleRouteChange());\n    window.addEventListener('DOMContentLoaded', () => this.handleRouteChange());\n  }\n\n  register(path: string, handler: RouteHandler): void {\n    this.routes.push({ path, handler });\n  }\n\n  navigate(path: string): void {\n    window.location.hash = path;\n  }\n\n  private handleRouteChange(): void {\n    const hash = window.location.hash.slice(1) || '/';\n    this.currentPath = hash;\n\n    // Find matching route\n    const route = this.routes.find(r => {\n      if (r.path.includes(':')) {\n        // Handle dynamic routes like /day/:id\n        const regex = new RegExp('^' + r.path.replace(/:[^/]+/g, '([^/]+)') + '$');\n        return regex.test(hash);\n      }\n      return r.path === hash;\n    });\n\n    if (route) {\n      route.handler();\n    } else {\n      // Default to home\n      const homeRoute = this.routes.find(r => r.path === '/');\n      if (homeRoute) {\n        homeRoute.handler();\n      }\n    }\n  }\n\n  getParams(): Record<string, string> {\n    const hash = window.location.hash.slice(1) || '/';\n    const params: Record<string, string> = {};\n\n    // Find matching route with params\n    this.routes.find(r => {\n      if (r.path.includes(':')) {\n        const pathParts = r.path.split('/');\n        const hashParts = hash.split('/');\n        \n        if (pathParts.length === hashParts.length) {\n          let matches = true;\n          for (let i = 0; i < pathParts.length; i++) {\n            if (pathParts[i].startsWith(':')) {\n              params[pathParts[i].slice(1)] = hashParts[i];\n            } else if (pathParts[i] !== hashParts[i]) {\n              matches = false;\n              break;\n            }\n          }\n          return matches;\n        }\n      }\n      return false;\n    });\n\n    return params;\n  }\n\n  getCurrentPath(): string {\n    return this.currentPath;\n  }\n\n  start(): void {\n    this.handleRouteChange();\n  }\n}\n\nexport const router = new Router();","import './ui/app-shell';\nimport './ui/view-home';\nimport './ui/view-day';\nimport './ui/view-session';\nimport './ui/update-indicator';\nimport { router } from './router';\nimport { programManager } from './program';\n\n// Service worker registration is now handled by AppUpdater\n\n// Initialize app with error handling\ndocument.addEventListener('DOMContentLoaded', async () => {\n  console.log('DOM loaded, initializing app...');\n  try {\n  // Initialize data\n  console.log('Initializing program manager...');\n  await programManager.initialize();\n  console.log('Program manager initialized');\n\n  // Wait for app-shell to be fully initialized\n  const appShell = document.querySelector('app-shell');\n  if (!appShell) {\n    console.error('App shell not found');\n    return;\n  }\n\n  console.log('Found app shell, waiting for shadow DOM...');\n\n  // Wait for the shadow DOM to be ready\n  await new Promise(resolve => {\n    const check = () => {\n      const shadowRoot = (appShell as any).shadowRoot;\n      if (shadowRoot && shadowRoot.querySelector('#content')) {\n        console.log('Shadow DOM ready');\n        resolve(void 0);\n      } else {\n        setTimeout(check, 10);\n      }\n    };\n    check();\n  });\n  \n  const content = (appShell as any).shadowRoot.querySelector('#content') as HTMLElement;\n  \n  if (!content) {\n    console.error('Content container not found');\n    return;\n  }\n\n  // Set up routing\n  router.register('/', () => showHome());\n  router.register('/day/:id', () => showDay());\n  router.register('/session/:id', () => showSession());\n\n  function showHome() {\n    content.innerHTML = '<view-home></view-home>';\n    const viewHome = content.querySelector('view-home');\n    \n    viewHome?.addEventListener('navigate-to-day', ((e: CustomEvent) => {\n      router.navigate(`/day/${e.detail.dayId}`);\n    }) as EventListener);\n  }\n\n  function showDay() {\n    const params = router.getParams();\n    const dayId = params.id;\n    \n    if (dayId) {\n      content.innerHTML = '<view-day></view-day>';\n      const viewDay = content.querySelector('view-day') as any;\n      \n      if (viewDay && viewDay.loadDay) {\n        viewDay.loadDay(dayId);\n      }\n\n      viewDay?.addEventListener('start-session', ((e: CustomEvent) => {\n        router.navigate(`/session/${e.detail.dayId}`);\n      }) as EventListener);\n    }\n  }\n\n  async function showSession() {\n    const params = router.getParams();\n    const dayId = params.id;\n    \n    if (dayId) {\n      const day = await programManager.getDay(dayId);\n      if (day) {\n        content.innerHTML = '<view-session></view-session>';\n        const viewSession = content.querySelector('view-session') as any;\n        \n        if (viewSession && viewSession.setDay) {\n          viewSession.setDay(day);\n        }\n\n        viewSession?.addEventListener('session-complete', ((e: CustomEvent) => {\n          console.log('Session completed:', e.detail);\n          router.navigate(`/day/${dayId}`);\n        }) as EventListener);\n      }\n    }\n  }\n\n  if (appShell) {\n    // Listen for day selection from header\n    appShell.addEventListener('day-selected', ((e: CustomEvent) => {\n      const dayNumber = e.detail.day;\n      const dayId = `p1_w1_d${dayNumber}`;\n      router.navigate(`/day/${dayId}`);\n    }) as EventListener);\n  }\n\n  // Start the router\n  console.log('Starting router...');\n  router.start();\n  \n  // Default to Day 1 if no hash is set\n  if (!window.location.hash || window.location.hash === '#/') {\n    console.log('No hash found, navigating to Day 1');\n    router.navigate('/day/p1_w1_d1');\n  } else {\n    console.log('Found hash:', window.location.hash);\n  }\n  \n  console.log('App initialization complete');\n  } catch (error) {\n    console.error('Failed to initialize app:', error);\n    // Show error message to user\n    document.body.innerHTML = `\n      <div style=\"padding: 20px; text-align: center; font-family: -apple-system, BlinkMacSystemFont, sans-serif;\">\n        <h1>Oops! Something went wrong</h1>\n        <p>There was an error loading Minimalift. Please refresh the page to try again.</p>\n        <button onclick=\"window.location.reload()\" style=\"padding: 10px 20px; font-size: 16px; background: #007AFF; color: white; border: none; border-radius: 6px; cursor: pointer;\">\n          Reload App\n        </button>\n      </div>\n    `;\n  }\n});"],"file":"assets/index-nFIpD_nU.js"}